{"version":3,"sources":["components/AutoWidth/AutoWidth.js","components/tooltip/tooltip.js","components/ScatterPlot/ScatterPlot.js","utils/collection.js","utils/format.js","constants.js","components/ConnectedScatterPlot/ConnectedScatterPlot.js","components/ColorLegend/ColorLegend.js","components/SmallMultipleConnected/SmallMultipleConnected.js","components/ConfigurePanel/ConfigurePanel.js","components/ConnectedScatterPlotGroups/ConnectedScatterPlotGroups.js","components/BigGraph/BigGraph.js","components/App/App.js","serviceWorker.js","index.js"],"names":["AutoWidth","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","width","defaultRenderWidth","debounceTime","updateWidth","debounce","bind","assertThisInitialized","window","addEventListener","parentMayResize","cancel","removeEventListener","ReactDOM","findDOMNode","domWidth","getResizeDOMNode","offsetWidth","setState","childToRender","child","children","React","cloneElement","react_default","a","createElement","className","Component","defaultProps","tableContent","entries","config","arguments","length","undefined","objectSpread","title","keys","keyFormat","k","valueFormat","v","output","concat","map","join","floatingTooltip","tooltipId","xOffset","yOffset","base","d3","tt","select","hideTooltip","style","toNum","str","Number","replace","updatePosition","event","ttw","tth","wscrY","scrollY","wscrX","scrollX","curX","document","all","clientX","pageX","curY","clientY","pageY","ttleft","innerWidth","tttop","innerHeight","empty","append","attr","html","showTooltip","content","ScatterPlot","zooming","showTable","handleLassoSelect","handleZoom","handleZoomingToggle","handleMouseOver","handleMouseOut","handleMouseOverCircle","handleMouseOutCircle","setup","update","d","onFilter","_this$props","xAxis","yAxis","xFunc","yFunc","_this$props2","xScale","yScale","zoomTransform","transform","rescaleX","rescaleY","scale","highlightCircle","chart","selectAll","_this$props3","colorScale","colorBy","tooltipTextFunc","onHover","_this$props4","highlight","tooltip","annotation","el","_this$props5","voronoiDiagram","mouseRadius","mousePos","invert","site","find","data","_this$props6","plotHeight","plotWidth","radius","exactMouse","cRoot","root","g","underlay","classed","that","on","setupZoom","yAxisLabel","xAxisLabel","zoomable","zoom","scaleExtent","padding","left","top","updateLayout","updateChart","updateAnnotation","updateAxes","_this$props7","_this$props8","labels","_this$props9","labelData","filter","country","binding","enter","merge","yValue","position","text","_this$props10","selectedData","hoverData","colorValue","_this$props11","datum","isfinite","key","merged","values","hoverFilter","includes","raise","collection","list","Array","isArray","some","r","exit","remove","_this$props12","xLabel","yLabel","_this$props13","bottom","_this2","_this$props14","height","ref","node","PureComponent","name","brushable","colorByFunc","x","y","addComputedProps","right","xExtent","xPad","Math","round","domain","range","yExtent","yPad","xValue","tickSizeOuter","ticks","pixelJitter","random","size","roundNumber","value","decimals","addCommas","nStr","split","x1","x2","rgx","test","formatNumber","number","thousand","EXTENT","METRICS","hdi","label","display","global","local","sortable","gdp","gni","efree","gini","year","CONFIGS","dataDisplay","options","id","sortOrder","SCATTER_LABELS","United States","Singapore","Italy","Iraq","Sudan","Chad","Algeria","Chile","Switzerland","ANNOTATIONS","Norway:hdi:gdp:local","dx","dy","United Kingdom:hdi:gdp:local","United States:hdi:gdp:local","Sweden:hdi:gdp:local","Canada:hdi:gdp:local","Libya:hdi:gdp:local","Libya:hdi:gdp:global","Iraq:hdi:gdp:local","Zimbabwe:hdi:gdp:local","Singapore:hdi:gdp:global","Singapore:efree:gdp:global","Azerbaijan:gini:gdp:local","Azerbaijan:gini:hdi:local","Azerbaijan:hdi:gini:local","Azerbaijan:gini:efree:local","Azerbaijan:gini:gdp:global","Azerbaijan:hdi:gini:global","Azerbaijan:gini:efree:global","El Salvador:efree:gdp:local","Sudan:hdi:gdp:local","Haiti:hdi:gdp:local","Greece:hdi:gdp:local","Jordan:hdi:gdp:local","United States:efree:gdp:local","Cambodia:hdi:gdp:global","Cambodia:hdi:gdp:local","Sri Lanka:hdi:gdp:global","Malawi:hdi:gdp:local","Central African Republic:hdi:gdp:local","Burundi:hdi:gdp:local","Madagascar:hdi:gdp:local","ConnectedScatterPlot","handleMouseover","handleMouseout","updateCanvas","xMetric","yMetric","xLowText","xHighText","yLowText","yHighText","dataBackground","sizeScale","lineWidth","lineCanvas","color","opacity","ctx","canvas","getContext","context","setTransform","clearRect","translate","strokeStyle","toString","forEach","beginPath","valuesFilter","stroke","i","segData","segColor","dotColor","arc","PI","fillStyle","fill","annotations","callouts","yearData","note","lineType","align","react_annotation_lib","editMode","onDragEnd","p","console","log","canvasStyle","renderAnnotations","zFunc","devicePixelRatio","curve","tension","changeInclude","ColorLegend","textAnchor","cx","cy","years","dotWidth","renderYear","push","SmallMultipleConnected","chartData","chartIndex","zLabel","dataGrouped","annotationKey","Col","sm","md","lg","components_AutoWidth_AutoWidth","components_ConnectedScatterPlot_ConnectedScatterPlot","index","region","components_ColorLegend_ColorLegend","Row","dist","renderLegend","renderRegion","renderChart","direction","sort","sortData","threshold","filterData","isMobile","regionCounts","c","keep","has","set","regionCount","get","limitData","_tooltipData","defineProperty","population","indexOf","objs","o","ConfigurePanel","configs","toggle","click","dataDisplayIndex","dropdownOpen","selectIndex","selectedId","dropdownId","prevState","ReactGA","category","action","option","optionIndex","onClick","dropdownState","items","DropdownItem","Dropdown","isOpen","DropdownToggle","caret","DropdownMenu","renderDropdown","ConnectedScatterPlotGroups","hover","b","lineColor","hoverCountry","allData","meanX","meanY","minX","maxX","minY","maxY","xMin","xMax","yMin","yMax","line","BigGraph","components_ConnectedScatterPlotGroups_ConnectedScatterPlotGroups","renderBigGraph","STRING_COLUMNS","ROUND_COLUMNS","gdp_per_cap","NULL_STRING","normalizeMinMax","normAttr","minData","maxData","NaN","EXCLUDE","processData","App","focusYear","scatterHover","handleScatterHover","handleConfigClick","configId","valueId","changesPath","process","getData","then","groupData","processGroupedData","_this$state","displayData","components_ScatterPlot_ScatterPlot","_this$state2","_tooltipData2","_this$state3","_configs$dataDisplay$","_configs$dataDisplay$2","slicedToArray","components_BigGraph_BigGraph","_this$state4","_configs$dataDisplay$3","_configs$dataDisplay$4","components_SmallMultipleConnected_SmallMultipleConnected","components_ConfigurePanel_ConfigurePanel","Container","href","target","rel","cite","renderScatterGNIvsKDI","renderScatterGNIvsEfree","renderConfigPanel","renderSmallMult","Boolean","location","hostname","match","initialize","pageview","pathname","search","render","components_App_App","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.97b5dba6.chunk.js","sourcesContent":["/**\n * @copyright 2018 Zymergen\n */\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash.debounce';\n\nconst propTypes = {\n  children: PropTypes.object,\n\n  /* The amount of delay between debounced calls (default: 100) */\n  debounceTime: PropTypes.number,\n\n  /* If set, the default width is set to this value and the child is\n     rendered. If null, the child is not rendered until a width is provided */\n  defaultRenderWidth: PropTypes.number,\n\n  /* If true, the component checks on componentDidUpdate to see if it needs to resize */\n  parentMayResize: PropTypes.bool,\n};\n\nconst defaultProps = {\n  parentMayResize: false,\n  defaultRenderWidth: null,\n  debounceTime: 100,\n};\n\n/**\n * Component for automatically setting a width prop to the DOM\n * node of the first child. Note that checking offsetWidth is a\n * somewhat expensive operation (forced reflow), so try and leave\n * `parentMayResize` false if you are having performance issues.\n *\n * Example usage:\n * <AutoWidth>\n *   <MyComponent />\n * </AutoWidth>\n *\n * MyComponent gets a `width` prop set.\n *\n */\nclass AutoWidth extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      width: props.defaultRenderWidth,\n    };\n\n    if (props.debounceTime) {\n      this.updateWidth = debounce(this.updateWidth.bind(this), props.debounceTime);\n    } else {\n      this.updateWidth = this.updateWidth.bind(this);\n    }\n  }\n\n  componentDidMount() {\n    this.updateWidth();\n    window.addEventListener('resize', this.updateWidth);\n  }\n\n  componentDidUpdate() {\n    const { parentMayResize } = this.props;\n\n    // have to update width of the parent can cause a resize without a window resize\n    // e.g. something collapses or expands.\n    if (parentMayResize) {\n      this.updateWidth();\n    }\n  }\n\n  componentWillUnmount() {\n    this.updateWidth.cancel();\n    window.removeEventListener('resize', this.updateWidth);\n  }\n\n  getResizeDOMNode() {\n    return ReactDOM.findDOMNode(this);\n  }\n\n  // Call set state to update the width so it starts an update of the child component\n  updateWidth() {\n    const { width } = this.state;\n    const domWidth = this.getResizeDOMNode().offsetWidth;\n    if (width !== domWidth) {\n      this.setState({\n        width: domWidth,\n      });\n    }\n  }\n\n  render() {\n    const { width } = this.state;\n\n    if (process.env.NODE_ENV !== 'production' && React.Children.count(this.props.children) > 1) {\n      console.warn('AutoWidth only works with a single child element.');\n    }\n\n    const child = this.props.children;\n    let childToRender;\n\n    // if we have a child and a width is provided, render the child with the width as a prop\n    if (child && width != null) {\n      childToRender = React.cloneElement(child, { width: this.state.width });\n    }\n\n    // we rely on this div getting the full width from the browser's layout\n    // and read its offsetWidth to set as the width to the child component.\n    return <div className=\"auto-width\">{childToRender}</div>;\n  }\n}\n\nAutoWidth.propTypes = propTypes;\nAutoWidth.defaultProps = defaultProps;\n\nexport default AutoWidth;\n","import * as d3 from 'd3';\nimport './tooltip.scss';\n\n/**\n * Format an object into a table for tooltip output.\n *\n * @param {Object} entries Object of items to display as a tooltip table.\n * @param {Object} config Configuration object that modifies the table generation.\n *  Possible values are:\n *  title: optional title for table\n *  keys: if provided, only display data from entries associated with these keys.\n *    This also can be used to specify the order of the data in the table.\n *    If not provided, all keys from `entries` are displayed.\n *  keyFormat: formatting function that takes a key and outputs a string to be displayed.\n *  valueFormat: formatting function that takes a value and outputs a string to be displayed.\n */\nexport function tableContent(entries, config = {}) {\n  const defaultConfig = {\n    title: null,\n    keys: null,\n    keyFormat: k => k,\n    valueFormat: v => v,\n  };\n  config = { ...defaultConfig, ...config };\n  config.keys = config.keys || Object.keys(entries);\n  let output = '<div>';\n  if (config.title) {\n    output += `<h2>${config.title}</h2>`;\n  }\n  output += '<table><tbody>';\n  const rows = config.keys.map(k => {\n    if (k in entries) {\n      return `<tr><td>${config.keyFormat(k)}</td><td>${config.valueFormat(entries[k])}</td></tr>`;\n    }\n    return '';\n  });\n  output += rows.join('');\n  output += '</tbody></table></div>';\n  return output;\n}\n\n/**\n * Format an object into a series of spans for tooltip output.\n *\n * @param {Object} entries\n * @param {Function} keyFormat\n */\nexport function spanContent(entries) {\n  const content = Object.keys(entries).map(k => {\n    return `<span class='name'>${k}: </span><span class='value'>${entries[k]}</span>`;\n  });\n\n  return content.join('<br/>');\n}\n\n/*\n * Creates tooltip with provided id that\n * floats on top of visualization.\n * Most styling is expected to come from CSS\n * so check out bubble_chart.scss for more details.\n */\nexport function floatingTooltip(tooltipId, config = { xOffset: 35, yOffset: -60, width: null }) {\n  // Local variable to hold tooltip div for\n  // manipulation in other functions.\n  const base = d3.select('body');\n\n  let tt = base.select(`#${tooltipId}`);\n\n  if (tt.empty()) {\n    base\n      .append('div')\n      .attr('class', 'tooltip')\n      .attr('id', tooltipId);\n    tt = base.select(`#${tooltipId}`);\n  }\n  tt.html('');\n\n  // Set a width if it is provided.\n  if (config.width) {\n    tt.style('width', config.width);\n  }\n\n  // Initially it is hidden.\n  hideTooltip();\n\n  /*\n   * Display tooltip with provided content.\n   *\n   * content is expected to be HTML string.\n   *\n   * event is d3.event for positioning.\n   */\n  function showTooltip(content, event) {\n    tt.style('opacity', 1.0)\n      .style('pointer-events', 'all')\n      .html(content);\n\n    updatePosition(event);\n  }\n\n  /*\n   * Hide the tooltip div.\n   */\n  function hideTooltip() {\n    tt.style('opacity', 0.0).style('pointer-events', 'none');\n  }\n\n  function toNum(str) {\n    return Number(str.replace(/[^\\d.-]/g, ''));\n  }\n\n  /*\n   * Figure out where to place the tooltip\n   * based on d3 mouse evenggt.\n   */\n  function updatePosition(event) {\n    var xOffset = config.xOffset;\n    var yOffset = config.yOffset;\n\n    var ttw = toNum(tt.style('width'));\n    var tth = toNum(tt.style('height'));\n\n    var wscrY = window.scrollY;\n    var wscrX = window.scrollX;\n\n    var curX = document.all ? event.clientX + wscrX : event.pageX;\n    var curY = document.all ? event.clientY + wscrY : event.pageY;\n    var ttleft =\n      curX - wscrX + xOffset * 2 + ttw > window.innerWidth ? curX - ttw - xOffset : curX + xOffset;\n\n    if (ttleft < wscrX + xOffset) {\n      ttleft = wscrX + xOffset;\n    }\n\n    var tttop =\n      curY - wscrY + yOffset * 2 + tth > window.innerHeight\n        ? curY - tth - yOffset * 2\n        : curY + yOffset;\n\n    if (tttop < wscrY + yOffset) {\n      tttop = curY + yOffset;\n    }\n\n    tt.style('top', tttop + 'px').style('left', ttleft + 'px');\n  }\n\n  return {\n    showTooltip: showTooltip,\n    hideTooltip: hideTooltip,\n    updatePosition: updatePosition,\n  };\n}\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport addComputedProps from 'react-computed-props';\nimport isfinite from 'lodash.isfinite';\nimport * as d3 from 'd3';\n\nimport { includesAny } from '../../utils/collection';\nimport { floatingTooltip } from '../tooltip/tooltip';\n\nimport './ScatterPlot.scss';\n\nfunction chartProps(props) {\n  const { data, height, width, xFunc, yFunc, colorByFunc, colorScale, exactMouse } = props;\n\n  const padding = {\n    top: 20,\n    right: 20,\n    bottom: 50,\n    left: 60,\n  };\n\n  const plotWidth = width - padding.left - padding.right;\n  const plotHeight = height - padding.top - padding.bottom;\n\n  const xExtent = d3.extent(data, xFunc);\n  const xPad = Math.round((xExtent[1] - xExtent[0]) / 20);\n  const xScale = d3\n    .scaleLinear()\n    .domain([xExtent[0] - xPad, xExtent[1] + xPad])\n    .range([0, plotWidth]);\n\n  const yExtent = d3.extent(data, yFunc);\n  const yPad = (yExtent[1] - yExtent[0]) / 20;\n  const yScale = d3\n    .scaleLinear()\n    .domain([yExtent[0] - yPad, yExtent[1] + yPad])\n    .range([plotHeight, 0]);\n\n  const xValue = d => xScale(xFunc(d));\n  const yValue = d => yScale(yFunc(d));\n  const colorValue = d => (colorByFunc(d) ? colorScale(colorByFunc(d)) : '#888');\n\n  const yAxis = d3\n    .axisLeft(yScale)\n    .tickSizeOuter(0)\n    .ticks(4);\n  const xAxis = d3\n    .axisBottom(xScale)\n    .tickSizeOuter(0)\n    .ticks(4);\n\n  let voronoiDiagram = d3.voronoi()([]);\n\n  if (!exactMouse) {\n    const pixelJitter = () => Math.random() - 0.5;\n    voronoiDiagram = d3\n      .voronoi()\n      .x(d => xValue(d) + pixelJitter())\n      .y(d => yValue(d) + pixelJitter())\n      .size([plotWidth, plotHeight])(data);\n  }\n\n  const mouseRadius = plotWidth / 10;\n\n  return {\n    plotWidth,\n    plotHeight,\n    padding,\n    colorValue,\n    xScale,\n    yScale,\n    xValue,\n    yValue,\n    xAxis,\n    yAxis,\n    voronoiDiagram,\n    mouseRadius,\n  };\n}\n\n/**\n * Scatter Plot component used to visualize two variables in the same chart.\n * Provides brushing capabilities for selecting subsets of data points.\n * Also provides zooming and hovering capabilities.\n */\nclass ScatterPlot extends PureComponent {\n  static propTypes = {\n    /**\n     * Boolean to enable/disable brushing interaction.\n     */\n    brushable: PropTypes.bool,\n\n    /**\n     * Function to extract attribute used to color dots with.\n     * Used in conjunction with `colorScale` a la:\n     * `colorScale(colorByFunc(d))`.\n     */\n    colorByFunc: PropTypes.func,\n\n    /**\n     * D3-style color scale function to color dots by.\n     */\n    colorScale: PropTypes.func,\n\n    /**\n     * Array of data objects to plot. x,y, and color values\n     * are extracted from each object in this array using\n     * xFunc, yFunc, and colorByFunc, respectively.\n     */\n    data: PropTypes.array,\n    labels: PropTypes.object,\n\n    /**\n     * A nice UX feature is when mousing over a plot,\n     * the nearest point to the mouse cursor can be detected\n     * using a voronoi diagram and its tooltip can be displayed\n     * without having to explicitly mouse onto that point.\n     * Unfortunately, these plots are flexible enough to allow data\n     * that is un-voronoi-able... causing crashing behavior. So,\n     * this approach (in certain contexts) needs to be abandoned.\n     * This boolean controls if 'exact mouse' (no voronoi) should\n     * be used for mouse-over or not.\n     * @default true\n     */\n    exactMouse: PropTypes.bool,\n\n    /**\n     * Height of component\n     */\n    height: PropTypes.number,\n\n    /**\n     * Values being hovered on.\n     */\n    hoverData: PropTypes.shape({\n      values: PropTypes.array,\n    }),\n\n    /**\n     * Unique name of plot. Used for\n     * maximization interaction.\n     */\n    name: PropTypes.string,\n\n    /**\n     * Callback for brushing interaction.\n     */\n    onFilter: PropTypes.func,\n\n    /**\n     *\n     */\n    onHover: PropTypes.func,\n\n    /**\n     * Radius of dots.\n     * @default 4\n     */\n    radius: PropTypes.number,\n\n    /**\n     * Values selected.\n     */\n    selectedData: PropTypes.shape({\n      values: PropTypes.array,\n    }),\n\n    /**\n     * Function used to generate tooltip text.\n     * function is provided data object.\n     */\n    tooltipTextFunc: PropTypes.func,\n\n    /**\n     * Width of component.\n     */\n    width: PropTypes.number,\n\n    /**\n     * Accessor function for x value of data object to display.\n     */\n    xFunc: PropTypes.func,\n\n    /**\n     * x-axis label.\n     */\n    xLabel: PropTypes.string,\n\n    /**\n     * Accessor function for y value of data object to display.\n     */\n    yFunc: PropTypes.func,\n\n    /**\n     * y-axis label.\n     */\n    yLabel: PropTypes.string,\n\n    /**\n     * Boolean controlling if chart is zoomable or not.\n     * @default true\n     */\n    zoomable: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    data: [],\n    labels: {},\n    name: 'scatter',\n    brushable: true,\n    colorByFunc: () => {},\n    height: 400,\n    hoverData: null,\n    selectedData: null,\n    width: 300,\n    onFilter: () => {},\n    colorScale: () => '#ddd',\n    xFunc: d => d.x,\n    yFunc: d => d.y,\n    radius: 4,\n    xLabel: '',\n    yLabel: '',\n    zoomable: false,\n    exactMouse: false,\n  };\n\n  /**\n   *\n   */\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      zooming: false,\n      showTable: false,\n    };\n\n    this.handleLassoSelect = this.handleLassoSelect.bind(this);\n    this.handleZoom = this.handleZoom.bind(this);\n    this.handleZoomingToggle = this.handleZoomingToggle.bind(this);\n    this.handleMouseOver = this.handleMouseOver.bind(this);\n    this.handleMouseOut = this.handleMouseOut.bind(this);\n    this.handleMouseOverCircle = this.handleMouseOverCircle.bind(this);\n    this.handleMouseOutCircle = this.handleMouseOutCircle.bind(this);\n  }\n\n  /**\n   * When the react component mounts, setup the d3 vis\n   */\n  componentDidMount() {\n    this.setup();\n  }\n\n  /**\n   * When the react component updates, update the d3 vis\n   */\n  componentDidUpdate() {\n    this.update();\n  }\n\n  /**\n   *\n   */\n  handleLassoSelect(d) {\n    this.props.onFilter(d);\n  }\n\n  /**\n   *\n   */\n  handleZoom() {\n    const { xAxis, yAxis, xFunc, yFunc } = this.props;\n    let { xScale, yScale } = this.props;\n\n    // record zoom transform to be used in\n    // other interaction callbacks.\n    this.zoomTransform = d3.event.transform;\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    this.yAxis.call(yAxis.scale(yScale));\n\n    this.xAxis.call(xAxis.scale(xScale));\n\n    const xValue = d => xScale(xFunc(d));\n    const yValue = d => yScale(yFunc(d));\n\n    this.highlightCircle(null);\n\n    this.chart\n      .selectAll('.dot')\n      .attr('cx', xValue)\n      .attr('cy', yValue);\n  }\n\n  /**\n   *\n   */\n  handleZoomingToggle() {\n    const { zooming } = this.state;\n    this.setState({\n      zooming: !zooming,\n    });\n  }\n\n  /**\n   *\n   */\n  highlightCircle(d) {\n    const { xFunc, yFunc, colorScale, colorBy, tooltipTextFunc, onHover } = this.props;\n    let { xScale, yScale } = this.props;\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    if (!d) {\n      this.highlight.style('display', 'none');\n      this.tooltip.hideTooltip();\n      this.annotation.attr('opacity', 1.0);\n    } else {\n      this.highlight\n        .style('display', '')\n        .style('stroke', colorScale(d[colorBy]))\n        .attr('cx', xScale(xFunc(d)))\n        .attr('cy', yScale(yFunc(d)));\n      if (tooltipTextFunc) {\n        this.tooltip.showTooltip(tooltipTextFunc(d), d3.event);\n      }\n      this.annotation.attr('opacity', 0.3);\n    }\n\n    if (onHover) {\n      onHover(d);\n    }\n  }\n\n  /**\n   *\n   */\n  handleMouseOver(el) {\n    const { voronoiDiagram, mouseRadius } = this.props;\n\n    let mousePos = d3.mouse(el);\n    mousePos = this.zoomTransform.invert(mousePos);\n    const site = voronoiDiagram.find(mousePos[0], mousePos[1], mouseRadius);\n    this.highlightCircle(site && site.data);\n  }\n\n  /**\n   *\n   */\n  handleMouseOut() {\n    this.highlightCircle(null);\n  }\n\n  /**\n   *\n   */\n  handleMouseOverCircle(d) {\n    this.highlightCircle(d);\n  }\n\n  /**\n   *\n   */\n  handleMouseOutCircle() {\n    this.highlightCircle(null);\n  }\n\n  /**\n   *\n   */\n  setup() {\n    const { plotHeight, plotWidth, radius, exactMouse } = this.props;\n    const cRoot = d3.select(this.root);\n\n    this.g = cRoot.append('g');\n\n    this.underlay = this.g\n      .append('rect')\n      .classed('underlay', true)\n      .attr('width', plotWidth)\n      .attr('height', plotHeight)\n      .style('fill', 'white');\n\n    const that = this;\n    if (!exactMouse) {\n      this.underlay\n        .on('mousemove', function(d) {\n          that.handleMouseOver(this, d);\n        })\n        .on('mouseleave', function() {\n          that.handleMouseOut();\n        });\n    }\n\n    this.setupZoom(this.underlay);\n\n    this.chart = this.g.append('g').classed('chart-group', true);\n    this.tooltip = floatingTooltip('scatter_tooltip', { xOffset: 5, yOffset: 20 });\n\n    this.highlight = this.g\n      .append('circle')\n      .attr('class', 'highlight-circle')\n      .attr('r', radius * 2)\n      .style('fill', 'none')\n      .style('display', 'none');\n\n    this.annotation = this.g\n      .append('g')\n      .classed('annotation', true)\n      .attr('pointer-events', 'none');\n\n    this.xAxis = this.g.append('g').classed('x-axis', true);\n    this.yAxis = this.g.append('g').classed('y-axis', true);\n    this.yAxisLabel = this.g\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle');\n\n    this.xAxisLabel = this.g\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle');\n\n    this.update();\n  }\n\n  /**\n   *\n   */\n  setupZoom(underlay) {\n    const { zoomable } = this.props;\n    this.zoomTransform = d3.zoomIdentity;\n\n    if (zoomable) {\n      this.zoom = d3\n        .zoom()\n        .scaleExtent([1 / 4, 8])\n        .on('zoom', this.handleZoom);\n\n      underlay.call(this.zoom);\n    }\n  }\n\n  /**\n   *\n   */\n  update() {\n    const { padding } = this.props;\n    this.g.attr('transform', `translate(${padding.left} ${padding.top})`);\n\n    this.updateLayout();\n    this.updateChart();\n    this.updateAnnotation();\n    this.updateAxes();\n  }\n\n  /**\n   *\n   */\n  updateLayout() {\n    const { plotHeight, plotWidth } = this.props;\n\n    this.underlay.attr('width', plotWidth).attr('height', plotHeight);\n  }\n\n  updateAnnotation() {\n    const { data, labels, xFunc, yFunc } = this.props;\n    let { xScale, yScale } = this.props;\n\n    const labelData = data.filter(d => labels[d.country]);\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    const xValue = d => xScale(xFunc(d));\n    const yValue = d => yScale(yFunc(d));\n\n    const binding = this.annotation.selectAll('.label').data(labelData, d => d.country);\n\n    const enter = binding\n      .enter()\n      .append('text')\n      .classed('label', true);\n    const merged = enter.merge(binding);\n\n    merged\n      .attr('x', xValue)\n      .attr('y', d => yValue(d))\n      .attr('dy', d => (labels[d.country].position === 'below' ? 15 : 3))\n      .attr('dx', d => (labels[d.country].position === 'below' ? null : 8))\n      .attr('text-anchor', d => (labels[d.country].position === 'below' ? 'middle' : 'start'))\n      .text(d => d.country);\n  }\n\n  /**\n   *\n   */\n  updateChart() {\n    const {\n      data,\n      selectedData,\n      hoverData,\n      xFunc,\n      yFunc,\n      colorValue,\n      radius,\n      exactMouse,\n    } = this.props;\n\n    let { xScale, yScale } = this.props;\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    const xValue = d => xScale(xFunc(d));\n    const yValue = d => yScale(yFunc(d));\n\n    const binding = this.chart\n      .selectAll('.dot')\n      .data(\n        data.filter(datum => isfinite(xFunc(datum)) && isfinite(yFunc(datum))),\n        datum => datum.key,\n      );\n\n    const enter = binding\n      .enter()\n      .append('circle')\n      .classed('dot', true);\n\n    const merged = enter.merge(binding);\n\n    merged\n      .attr('cx', xValue)\n      .attr('cy', yValue)\n      .attr('r', radius)\n      .attr('fill', colorValue);\n\n    if (exactMouse) {\n      merged.on('mouseover', this.handleMouseOverCircle).on('mouseout', this.handleMouseOutCircle);\n    } else {\n      merged.style('pointer-events', 'none');\n    }\n\n    merged\n      .classed('highlight', false)\n      .classed('dim', false)\n      .classed('selected', false);\n\n    if (hoverData && hoverData.values.length > 0) {\n      const hoverFilter = d => hoverData.values.includes(d.key);\n\n      merged\n        .classed('highlight', false)\n        .classed('dim', true)\n        .filter(hoverFilter)\n        .classed('highlight', true)\n        .classed('dim', false)\n        .attr('r', radius * 1.5)\n        .raise()\n        .filter(hoverFilter)\n        .classed('selected', true)\n        .raise();\n    }\n\n    if (selectedData && selectedData.values && selectedData.values.length > 0) {\n      merged\n        .filter(d => d[selectedData.key] && includesAny(d[selectedData.key], selectedData.values))\n        .classed('highlight', true)\n        .classed('dim', false)\n        .raise();\n    }\n\n    binding.exit().remove();\n  }\n\n  /**\n   *\n   */\n  updateAxes() {\n    const { xAxis, yAxis, xLabel, yLabel, plotHeight, plotWidth, padding } = this.props;\n\n    let { xScale, yScale } = this.props;\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    this.xAxis.attr('transform', `translate(${0}, ${plotHeight})`).call(xAxis.scale(xScale));\n\n    this.yAxis.call(yAxis.scale(yScale));\n\n    this.yAxisLabel\n      .attr('transform', `rotate(270) translate(${-plotHeight / 2} ${-padding.left + 18})`)\n      .text(yLabel);\n\n    this.xAxisLabel\n      .attr(\n        'transform',\n        `translate(${plotWidth / 2} ${plotHeight + padding.top + padding.bottom / 3})`,\n      )\n      .text(xLabel);\n  }\n\n  /**\n   *\n   */\n  render() {\n    const { height, width } = this.props;\n\n    // keeps plot from overlapping on small screens - as\n    // elements are absolutely positioned within.\n    const style = { height: height };\n\n    return (\n      <div className=\"ScatterPlot\">\n        <div className=\"chart-brush\" style={style}>\n          <svg\n            className=\"chart\"\n            ref={node => {\n              this.root = node;\n            }}\n            height={height}\n            width={width}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default addComputedProps(chartProps)(ScatterPlot);\n","/**\n * Returns true if collection includes any in list\n * @param  {Array} collection Array of values to search\n * @param  {Array} list values to check for\n * @returns {Bool} true if collection contains any\n *  of the elements in list\n */\nexport function includesAny(collection, list) {\n  if (!collection || !list) {\n    return false;\n  }\n\n  if (!Array.isArray(collection)) {\n    collection = [collection];\n  }\n\n  // array.some tests whether at least one element\n  // in the array passes the test\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some\n  return collection.some(r => list.includes(r));\n}\n","/**\n * Round a value to a given number of decimals\n * @param {Number} value Value to round.\n * @param {Number} decimals decimals to round to.\n * @return {Number} rounded number\n */\nexport function roundNumber(value, decimals) {\n  return Number(`${Math.round(`${value}e${decimals}`)}e-${decimals}`);\n}\n\n/**\n * Add commas to a number to make it look better\n * @param {Number} nStr to add commas to\n * @return {String} number with commas\n */\nexport function addCommas(nStr) {\n  if (!nStr) {\n    nStr = 0;\n  }\n  nStr = +nStr + \"\";\n  const x = nStr.split(\".\");\n  let x1 = x[0];\n  const x2 = x.length > 1 ? `.${x[1]}` : \"\";\n  const rgx = /(\\d+)(\\d{3})/;\n  while (rgx.test(x1)) {\n    x1 = x1.replace(rgx, \"$1,$2\");\n  }\n  return x1 + x2;\n}\n\n/**\n * @param {Number} number Number to format\n * @return {String} number with commas and M/B instaed of million / billion\n */\nexport function formatNumber(number, thousand = false) {\n  if (!number) {\n    number = 0;\n  }\n  if (number > 999999999) {\n    number = roundNumber(number / 1000000000.0, 1);\n    return `${addCommas(number)}B`;\n  } else if (number > 999999) {\n    number = roundNumber(number / 1000000.0, 1);\n    return `${addCommas(number)}M`;\n  } else if (number > 999 && thousand) {\n    number = roundNumber(number / 1000.0, 1);\n    return `${addCommas(number)}K`;\n  }\n  return addCommas(number);\n}\n","export const EXTENT = [-0.05, 1.05];\n\nexport const METRICS = {\n  hdi: {\n    label: 'Human Development Index',\n    display: 'hdi',\n    global: 'hdi_norm',\n    local: 'hdi_norm_local',\n    sortable: 'hdi_max',\n  },\n  gdp: {\n    label: 'GDP per Capita',\n    display: 'gdp_per_cap',\n    global: 'gdp_norm',\n    local: 'gdp_norm_local',\n    sortable: 'gdp_max',\n  },\n  gni: {\n    label: 'GNI per Capita',\n    display: 'gni_per_cap',\n    global: 'gni_norm',\n    local: 'gni_norm_local',\n    sortable: 'gni_max',\n  },\n  efree: {\n    label: 'Economic Freedom',\n    display: 'efree',\n    global: 'efree_norm',\n    local: 'efree_norm_local',\n    sortable: 'efree_max',\n  },\n  gini: {\n    label: 'Gini Index',\n    display: 'gini',\n    global: 'gini_norm',\n    local: 'gini_norm_local',\n    sortable: 'gini_max',\n  },\n  year: { label: 'Year', display: 'year' },\n};\n\nexport const CONFIGS = {\n  dataDisplay: {\n    options: [\n      { label: 'HDI vs GDP', id: 'hdi_gdp' },\n      { label: 'Economic Freedom vs GDP', id: 'efree_gdp' },\n      { label: 'Gini vs GDP', id: 'gini_gdp' },\n      { label: 'HDI vs Economic Freedom', id: 'hdi_efree' },\n      { label: 'HDI vs Gini', id: 'hdi_gini' },\n      { label: 'Economic Freedom vs Gini', id: 'efree_gini' },\n    ],\n  },\n  sortOrder: {\n    options: [\n      { label: 'By Region', id: 'region' },\n      { label: 'By HDI', id: 'hdi' },\n      { label: 'By GDP', id: 'gdp' },\n      { label: 'By Economic Freedom', id: 'efree' },\n      { label: 'By Gini Index', id: 'gini' },\n      { label: 'Alphabetically', id: 'alpha' },\n    ],\n  },\n  scale: {\n    options: [{ label: 'Country-level', id: 'local' }, { label: 'Global', id: 'global' }],\n  },\n};\n\nexport const SCATTER_LABELS = {\n  hdi: {\n    'United States': { id: 'United States', position: 'below' },\n    Singapore: { id: 'Singapore', position: 'below' },\n    Italy: { id: 'Italy', position: 'below' },\n    Iraq: { id: 'Italy', position: 'below' },\n    Sudan: { id: 'Italy', position: 'right' },\n    Chad: { id: 'Italy', position: 'right' },\n  },\n  efree: {\n    'United States': { id: 'United States', position: 'below' },\n    Singapore: { id: 'Singapore', position: 'below' },\n    Italy: { id: 'Italy', position: 'below' },\n    Iraq: { id: 'Iraq', position: 'below' },\n    Algeria: { id: 'Algeria', position: 'below' },\n    Chile: { id: 'Chile', position: 'below' },\n    Switzerland: { id: 'Switzerland', position: 'below' },\n  },\n};\n\nexport const ANNOTATIONS = {\n  'Norway:hdi:gdp:local': [{ year: 2015, text: 'Falling oil prices impact GDP.', dx: -81, dy: 8 }],\n  'United Kingdom:hdi:gdp:local': [{ year: 2009, text: 'The Great Recession.', dx: -38, dy: -26 }],\n  'United States:hdi:gdp:local': [{ year: 2009, text: 'The Great Recession.', dx: -27, dy: -9 }],\n  'Sweden:hdi:gdp:local': [{ year: 2009, text: 'The Great Recession.', dx: -9, dy: -76 }],\n  'Canada:hdi:gdp:local': [{ year: 2009, text: 'The Great Recession.', dx: -16, dy: -24 }],\n  'Libya:hdi:gdp:local': [{ year: 2011, text: 'First Libyan Civil War.', dx: 0, dy: -139 }],\n  'Libya:hdi:gdp:global': [{ year: 2011, text: 'First Libyan Civil War.', dx: 70, dy: 50 }],\n  'Iraq:hdi:gdp:local': [\n    {\n      year: 2003,\n      text: 'US invades of Iraq for weapons of mass destruction.',\n      dx: 0,\n      dy: -139,\n    },\n  ],\n  'Zimbabwe:hdi:gdp:local': [\n    {\n      year: 2009,\n      text: 'Power-sharing agreement between president and prime minister.',\n      dx: 0,\n      dy: -109,\n    },\n  ],\n  'Singapore:hdi:gdp:global': [\n    {\n      year: 2010,\n      text: 'Singapore has one of the most open and least corrupt economies in the world.',\n      dx: -5,\n      dy: 97,\n    },\n  ],\n  'Singapore:efree:gdp:global': [\n    {\n      year: 2010,\n      text: 'Singapore has one of the most open and least corrupt economies in the world.',\n      dx: -5,\n      dy: 97,\n    },\n  ],\n  'Azerbaijan:gini:gdp:local': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: 59,\n      dy: -41,\n    },\n  ],\n  'Azerbaijan:gini:hdi:local': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: 59,\n      dy: -41,\n    },\n  ],\n  'Azerbaijan:hdi:gini:local': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: 59,\n      dy: -41,\n    },\n  ],\n  'Azerbaijan:gini:efree:local': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: 59,\n      dy: -41,\n    },\n  ],\n  'Azerbaijan:gini:gdp:global': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: 59,\n      dy: -41,\n    },\n  ],\n  'Azerbaijan:hdi:gini:global': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: 65,\n      dy: 31,\n    },\n  ],\n  'Azerbaijan:gini:efree:global': [\n    {\n      year: 2002,\n      text: 'Researchers suggest low Gini values are due to data collection issues.',\n      dx: -26,\n      dy: -38,\n    },\n  ],\n  'El Salvador:efree:gdp:local': [\n    {\n      year: 2011,\n      text: 'Bureaucracy and government interference has erroded Economic Freedom.',\n      dx: 4,\n      dy: -43,\n    },\n  ],\n  'Sudan:hdi:gdp:local': [{ year: 2013, text: 'South Sudanese Civil War.', dx: -1, dy: 71 }],\n  'Haiti:hdi:gdp:local': [{ year: 2010, text: '2010 Haiti earthquake.', dx: 0, dy: -90 }],\n  'Greece:hdi:gdp:local': [{ year: 2009, text: 'Greek government debt crisis.', dx: -8, dy: 98 }],\n  'Jordan:hdi:gdp:local': [{ year: 2011, text: 'Arab Spring protests.', dx: -9, dy: 58 }],\n  'United States:efree:gdp:local': [\n    {\n      year: 2010,\n      text: 'Federal regulations increased during Barack Obama’s presidency',\n      dx: -2,\n      dy: 33,\n    },\n  ],\n  'Cambodia:hdi:gdp:global': [\n    { year: 2011, text: 'Poverty rate has been cut in half since 2004.', dx: 66, dy: 0 },\n  ],\n  'Cambodia:hdi:gdp:local': [\n    { year: 2011, text: 'Poverty rate has been cut in half since 2004.', dx: 12, dy: 72 },\n  ],\n  'Sri Lanka:hdi:gdp:global': [\n    {\n      year: 2008,\n      text: 'Sri Lanka provides free health and education services to its citizens.',\n      dx: 70,\n      dy: 57,\n    },\n  ],\n  'Malawi:hdi:gdp:local': [{ year: 2002, text: 'Malawian food crisis.', dx: 22, dy: -113 }],\n  'Central African Republic:hdi:gdp:local': [\n    { year: 2012, text: 'Start of Civil War.', dx: -46, dy: -1 },\n  ],\n  'Burundi:hdi:gdp:local': [\n    { year: 2015, text: 'Protesting and Attempted coup.', dx: -69, dy: 14 },\n  ],\n  'Madagascar:hdi:gdp:local': [\n    { year: 2015, text: 'Ousting of president starts economic crisis.', dx: -87, dy: 4 },\n  ],\n};\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport addComputedProps from 'react-computed-props';\nimport * as d3 from 'd3';\n// import {Delaunay} from \"d3-delaunay\";\n\nimport { AnnotationCalloutElbow } from 'react-annotation';\nimport { floatingTooltip } from '../tooltip/tooltip';\n\nimport './ConnectedScatterPlot.scss';\n\n/**\n *\n * @param {*} props\n */\nfunction chartProps(props) {\n  const { data, xFunc, yFunc, zFunc, colorScale, height, width, scale } = props;\n\n  let { xExtent, yExtent } = props;\n\n  const padding = {\n    top: 20,\n    right: 20,\n    bottom: 40,\n    left: 40,\n  };\n\n  // scaling for retina displays\n  let sizeScale = 1.0;\n  if (window.devicePixelRatio) {\n    sizeScale = window.devicePixelRatio;\n  }\n\n  const radius = scale === 'local' ? 5 : 2;\n  const lineWidth = scale === 'local' ? 3 : 1;\n\n  const plotWidth = width - padding.left - padding.right;\n  const plotHeight = height - padding.top - padding.bottom;\n\n  // const dataFiltered = data.filter(datum => isfinite(xFunc(datum)) && isfinite(yFunc(datum)));\n\n  xExtent = xExtent || d3.extent(data, xFunc);\n  const xScale = d3\n    .scaleLinear()\n    .domain(xExtent)\n    .range([0, plotWidth]);\n\n  yExtent = yExtent || d3.extent(data, yFunc);\n  const yScale = d3\n    .scaleLinear()\n    .domain(yExtent)\n    .range([plotHeight, 0]);\n\n  const xValue = d => xScale(xFunc(d));\n  const yValue = d => yScale(yFunc(d));\n\n  const lineCanvas = d3\n    .line()\n    .x(xValue)\n    .y(yValue)\n    .curve(d3.curveCardinal.tension(0.3));\n\n  let colorValue = d => '#ddd';\n  if (colorScale) {\n    colorValue = d => colorScale(zFunc(d));\n  }\n\n  let voronoiDiagram = null;\n\n  if (data && data.length > 0) {\n    const pixelJitter = () => Math.random() - 0.5;\n    voronoiDiagram = d3\n      .voronoi()\n      .x(d => xValue(d) + pixelJitter())\n      .y(d => yValue(d) + pixelJitter())\n      .size([plotWidth, plotHeight])(data);\n\n    // voronoiDiagram = Delaunay.from(data, d => xValue(d) + pixelJitter(), d => yValue(d) + pixelJitter())\n  }\n\n  const mouseRadius = plotWidth / 3;\n\n  // const yAxis = d3.axisLeft(yScale).tickSizeOuter(0);\n  // const xAxis = d3.axisBottom(xScale).tickSizeOuter(0);\n\n  return {\n    lineCanvas,\n    padding,\n    plotHeight,\n    plotWidth,\n    xScale,\n    yScale,\n    xValue,\n    yValue,\n    colorValue,\n    radius,\n    lineWidth,\n    voronoiDiagram,\n    mouseRadius,\n    // xAxis, yAxis,\n    sizeScale,\n  };\n}\n\n/**\n *\n */\nclass ConnectedScatterPlot extends PureComponent {\n  static propTypes = {\n    data: PropTypes.array,\n    name: PropTypes.string,\n    radius: PropTypes.number,\n    scale: PropTypes.string,\n    xFunc: PropTypes.func,\n    yFunc: PropTypes.func,\n    xLabel: PropTypes.string,\n    yLabel: PropTypes.string,\n    xExtent: PropTypes.array,\n    yExtent: PropTypes.array,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    tooltipTextFunc: PropTypes.func,\n    annotations: PropTypes.array,\n  };\n\n  static defaultProps = {\n    data: [],\n    radius: 4,\n    height: 300,\n    width: 300,\n    name: '',\n    xFunc: d => d.x,\n    yFunc: d => d.x,\n    xLabel: '',\n    yLabel: '',\n    tooltipTextFunc: d => '',\n    colorScale: () => '#ddd',\n    annotations: [],\n  };\n\n  /**\n   *\n   */\n  constructor(props) {\n    super(props);\n\n    this.handleMouseover = this.handleMouseover.bind(this);\n    this.handleMouseout = this.handleMouseout.bind(this);\n  }\n\n  /**\n   * When the react component mounts, setup the d3 vis\n   */\n  componentDidMount() {\n    this.setup();\n  }\n\n  /**\n   * When the react component updates, update the d3 vis\n   */\n  componentDidUpdate() {\n    this.update();\n  }\n\n  /**\n   *\n   */\n  handleMouseover(el) {\n    const { voronoiDiagram, mouseRadius } = this.props;\n\n    let mousePos = d3.mouse(el);\n    mousePos = this.zoomTransform.invert(mousePos);\n    const site = voronoiDiagram.find(mousePos[0], mousePos[1], mouseRadius);\n    this.highlightCircle(site && site.data);\n  }\n\n  /**\n   *\n   */\n  handleMouseout(el) {\n    this.highlightCircle(null);\n  }\n\n  /**\n   *\n   */\n  highlightCircle(d) {\n    const { xFunc, yFunc, colorScale, colorBy, tooltipTextFunc, onHover } = this.props;\n    let { xScale, yScale } = this.props;\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    if (!d) {\n      this.highlight.style('display', 'none');\n      this.tooltip.hideTooltip();\n    } else {\n      this.highlight\n        .style('display', '')\n        .style('stroke', colorScale(d[colorBy]))\n        .attr('cx', xScale(xFunc(d)))\n        .attr('cy', yScale(yFunc(d)));\n      if (tooltipTextFunc) {\n        this.tooltip.showTooltip(tooltipTextFunc(d), d3.event);\n      }\n    }\n\n    if (onHover) {\n      onHover(d);\n    }\n  }\n\n  /**\n   *\n   */\n  setup() {\n    const { plotWidth, plotHeight, radius } = this.props;\n\n    this.zoomTransform = d3.zoomIdentity;\n\n    const cRoot = d3.select(this.root);\n\n    this.g = cRoot.append('g');\n\n    const that = this;\n    this.underlay = this.g\n      .append('rect')\n      .classed('underlay', true)\n      .attr('width', plotWidth)\n      .attr('height', plotHeight)\n      .style('fill', 'white')\n      .style('opacity', 0.001)\n      .on('mousemove', function(d) {\n        that.handleMouseover(this, d);\n      })\n      .on('mouseleave', function() {\n        that.handleMouseout();\n      });\n    this.chart = this.g.append('g').classed('chart-group', true);\n    this.tooltip = floatingTooltip('connected_tooltip', { xOffset: 5, yOffset: 20 });\n\n    this.highlight = this.g\n      .append('circle')\n      .attr('class', 'highlight-circle')\n      .attr('r', radius + 2)\n      .style('fill', 'none')\n      .style('pointer-events', 'none')\n      .style('display', 'none');\n\n    this.xAxis = this.g\n      .append('g')\n      .classed('x-axis', true)\n      .style('pointer-events', 'none');\n\n    this.xAxis.append('line').classed('bar', true);\n    this.xAxis.append('text').classed('low', true);\n    this.xAxis.append('text').classed('high', true);\n\n    this.yAxis = this.g\n      .append('g')\n      .classed('y-axis', true)\n      .style('pointer-events', 'none');\n\n    this.yAxis.append('line').classed('bar', true);\n    this.yAxis.append('text').classed('low', true);\n    this.yAxis.append('text').classed('high', true);\n\n    this.yAxisLabel = this.g\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle');\n\n    this.xAxisLabel = this.g\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle');\n\n    this.update();\n  }\n\n  /**\n   *\n   */\n  update() {\n    const { padding } = this.props;\n    this.g.attr('transform', `translate(${padding.left} ${padding.top})`);\n\n    // this.updateChart();\n    this.updateLayout();\n    this.updateAxes();\n    this.updateCanvas();\n  }\n\n  /**\n   *\n   */\n  updateLayout() {\n    const { plotHeight, plotWidth } = this.props;\n\n    this.underlay.attr('width', plotWidth).attr('height', plotHeight);\n  }\n\n  /**\n   *\n   */\n  updateChart() {\n    const { data, xValue, yValue, colorValue, radius } = this.props;\n\n    const binding = this.chart.selectAll('.dot').data(data, datum => datum.key);\n\n    const enter = binding\n      .enter()\n      .append('circle')\n      .classed('dot', true);\n\n    const merged = enter.merge(binding);\n\n    merged\n      .attr('cx', xValue)\n      .attr('cy', yValue)\n      .attr('r', radius)\n      .attr('fill', colorValue);\n    // .attr('stroke', 'red')\n    // .attr('stroke-width', 2);\n    merged.style('pointer-events', 'none');\n\n    binding.exit().remove();\n  }\n\n  /**\n   *\n   */\n  updateAxes() {\n    const { xMetric, yMetric, xLabel, yLabel, plotHeight, plotWidth, padding } = this.props;\n\n    this.xAxis.attr('transform', `translate(${0}, ${plotHeight})`);\n    this.xAxis.attr('font-size', 10).attr('fill', 'none');\n    this.yAxis.attr('font-size', 10).attr('fill', 'none');\n\n    const xLowText = xMetric === 'gini' ? 'more equal' : 'low';\n    const xHighText = xMetric === 'gini' ? 'less equal' : 'high';\n\n    const yLowText = yMetric === 'gini' ? 'more equal' : 'low';\n    const yHighText = yMetric === 'gini' ? 'less equal' : 'high';\n\n    this.xAxis\n      .select('.bar')\n      .attr('x1', 0)\n      .attr('x2', plotWidth)\n      .attr('y1', 0)\n      .attr('y2', 0)\n      .style('stroke-width', 1)\n      .style('stroke', 'black')\n      .style('fill', 'none');\n\n    this.xAxis\n      .select('.low')\n      .attr('y', 9)\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .text(xLowText);\n\n    this.xAxis\n      .select('.high')\n      .attr('y', 9)\n      .attr('x', plotWidth)\n      .attr('text-anchor', 'end')\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .text(xHighText);\n\n    this.yAxis\n      .select('.bar')\n      .attr('x1', 0)\n      .attr('x2', 0)\n      .attr('y1', 0)\n      .attr('y2', plotHeight)\n      .style('stroke-width', 1)\n      .style('stroke', 'black')\n      .style('fill', 'none');\n\n    this.yAxis\n      .select('.low')\n      .attr('y', 9)\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .attr('transform', `rotate(270) translate(${-plotHeight} ${-padding.left + 18})`)\n      .text(yLowText);\n\n    this.yAxis\n      .select('.high')\n      .attr('y', 9)\n      .attr('x', 0)\n      .attr('text-anchor', 'end')\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .attr('transform', `rotate(270) translate(${0} ${-padding.left + 18})`)\n      .text(yHighText);\n\n    this.yAxisLabel\n      .attr('transform', `rotate(270) translate(${-plotHeight / 2} ${-padding.left + 18})`)\n      .text(yLabel);\n\n    this.xAxisLabel\n      .attr(\n        'transform',\n        `translate(${plotWidth / 2} ${plotHeight + padding.top + padding.bottom / 3})`,\n      )\n      .text(xLabel);\n  }\n\n  /**\n   * Rerenders the chart on the canvas. Recomputes data sorting and scales.\n   */\n  updateCanvas() {\n    const {\n      data,\n      dataBackground,\n      sizeScale,\n      width,\n      height,\n      padding,\n      lineWidth,\n      scale,\n      lineCanvas,\n      colorValue,\n      xValue,\n      yValue,\n      radius,\n      name,\n    } = this.props;\n\n    let color = d3.color('#ccc');\n    color.opacity = scale === 'global' ? 0.7 : 0.15;\n\n    // get context\n    const ctx = this.canvas.getContext('2d');\n\n    lineCanvas.context(ctx);\n\n    // Reset transform to ensure scale setting is appropriate.\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.scale(sizeScale, sizeScale);\n    // draw main bars\n    ctx.clearRect(0, 0, width, height);\n    // have some padding\n    ctx.translate(padding.left, padding.top);\n\n    ctx.lineWidth = lineWidth;\n    ctx.strokeStyle = color.toString();\n    dataBackground.forEach(country => {\n      if (country.key !== name) {\n        ctx.beginPath();\n        lineCanvas(country.valuesFilter);\n        ctx.stroke();\n      }\n    });\n\n    ctx.lineWidth = lineWidth;\n    for (let i = 0; i < data.length - 1; i++) {\n      const segData = [data[i], data[i + 1]];\n      const segColor = colorValue(data[i]);\n      ctx.strokeStyle = segColor.toString();\n      ctx.beginPath();\n      lineCanvas(segData);\n      ctx.stroke();\n    }\n\n    data.forEach(year => {\n      let dotColor = colorValue(year);\n      ctx.beginPath();\n      ctx.arc(xValue(year), yValue(year), radius, 0, 2 * Math.PI, false);\n      ctx.fillStyle = dotColor.toString();\n      ctx.fill();\n    });\n  }\n\n  /**\n   *\n   */\n  updateAxesExact() {\n    const {\n      xAxis,\n      yAxis,\n      xLabel,\n      yLabel,\n      plotHeight,\n      plotWidth,\n      padding,\n      xScale,\n      yScale,\n    } = this.props;\n\n    this.xAxis.attr('transform', `translate(${0}, ${plotHeight})`).call(xAxis.scale(xScale));\n\n    this.yAxis.call(yAxis.scale(yScale));\n\n    this.yAxisLabel\n      .attr('transform', `rotate(270) translate(${-plotHeight / 2} ${-padding.left + 18})`)\n      .text(yLabel);\n\n    this.xAxisLabel\n      .attr(\n        'transform',\n        `translate(${plotWidth / 2} ${plotHeight + padding.top + padding.bottom / 3})`,\n      )\n      .text(xLabel);\n  }\n\n  /**\n   *\n   */\n  renderAnnotations() {\n    const { data, xValue, yValue, width, height, annotations, padding } = this.props;\n\n    if (!annotations || annotations.length === 0) {\n      return null;\n    }\n\n    const callouts = annotations.map(a => {\n      let yearData = data.filter(d => d.year === a.year);\n\n      if (!yearData || yearData.length === 0) {\n        return null;\n      }\n\n      yearData = yearData[0];\n\n      const note = { label: a.text, lineType: 'horizontal', align: null };\n\n      return (\n        <AnnotationCalloutElbow\n          key={a.year}\n          x={xValue(yearData)}\n          y={yValue(yearData)}\n          dx={a.dx}\n          dy={a.dy}\n          note={note}\n          color={'black'}\n          editMode={false}\n          onDragEnd={p => console.log(p)}\n        />\n      );\n    });\n\n    return (\n      <svg width={width} height={height} className=\"annotations\">\n        <g transform={`translate(${padding.left}, ${padding.top})`}>{callouts}</g>\n      </svg>\n    );\n  }\n\n  /**\n   *\n   */\n  render() {\n    const { name, height, width, sizeScale } = this.props;\n\n    let canvasStyle = {\n      width: width,\n      height: height,\n    };\n\n    return (\n      <div className=\"ConnectedScatterPlot\">\n        <h4 className=\"title\">{name}</h4>\n        <div className=\"chart-container\">\n          <canvas\n            className=\"chart-canvas\"\n            ref={node => {\n              this.canvas = node;\n            }}\n            style={canvasStyle}\n            width={width * sizeScale}\n            height={height * sizeScale}\n          />\n          <svg\n            className=\"chart\"\n            ref={node => {\n              this.root = node;\n            }}\n            height={height}\n            width={width}\n          />\n          {this.renderAnnotations()}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default addComputedProps(chartProps, {\n  changeInclude: [\n    'data',\n    'dataBackground',\n    'scale',\n    'sortOrder',\n    'width',\n    'height',\n    'xMetric',\n    'yMetric',\n  ],\n})(ConnectedScatterPlot);\n","import React, { Component } from \"react\";\nimport addComputedProps from \"react-computed-props\";\nimport * as d3 from \"d3\";\n\nimport \"./ColorLegend.scss\";\n\nfunction chartProps(props) {\n  const { domain } = props;\n  const years = d3.range(domain[0], domain[1] + 1, 2);\n  if (years[years.length - 1] !== domain[1]) {\n    years.push(domain[1]);\n  }\n  const radius = 8;\n  const spacer = 10;\n  const dotWidth = (radius * 2 + spacer) * years.length;\n  const xScale = d3\n    .scalePoint()\n    .domain(years)\n    .range([0, dotWidth]);\n  return { dotWidth, years, radius, xScale };\n}\n\nclass ColorLegend extends Component {\n  static defaultProps = {\n    height: 40\n  };\n\n  renderYear(year) {\n    const { xScale, radius, colorScale } = this.props;\n    return (\n      <g key={year} transform={`translate(${xScale(year)},${0})`}>\n        <text className=\"title\" textAnchor=\"middle\">\n          {year}\n        </text>\n        <circle cx={0} cy={13} r={radius} fill={colorScale(year)} />\n      </g>\n    );\n  }\n\n  render() {\n    const { years, dotWidth, height, radius } = this.props;\n    return (\n      <div className=\"ColorLegend\">\n        <svg className=\"dots\" width={dotWidth + radius * 4} height={height}>\n          <g transform={`translate(${radius * 2},${height / 4})`}>\n            {years.map(year => this.renderYear(year))}\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport default addComputedProps(chartProps)(ColorLegend);\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport addComputedProps from 'react-computed-props';\nimport { Row, Col } from 'reactstrap';\nimport * as d3 from 'd3';\nimport ConnectedScatterPlot from '../ConnectedScatterPlot/ConnectedScatterPlot';\nimport isfinite from 'lodash.isfinite';\n\nimport { isMobile, MobileView } from 'react-device-detect';\n\nimport ColorLegend from '../ColorLegend/ColorLegend';\nimport { tableContent } from '../tooltip/tooltip';\nimport { formatNumber } from '../../utils/format';\n\nimport './SmallMultipleConnected.scss';\nimport AutoWidth from '../AutoWidth/AutoWidth';\n\nimport { METRICS, EXTENT, ANNOTATIONS } from '../../constants';\n\n/**\n *\n * @param {*} data\n * @param {*} sortOrder\n * @param {*} xFunc\n * @param {*} yFunc\n * @param {*} zFunc\n */\nfunction sortData(data, sortOrder, xFunc, yFunc, zFunc) {\n  if (METRICS[sortOrder]) {\n    const direction = sortOrder === 'gini' ? 'ascending' : 'descending';\n    data = data.sort((x, y) =>\n      d3[direction](x[METRICS[sortOrder].sortable], y[METRICS[sortOrder].sortable]),\n    );\n  } else if (sortOrder === 'region') {\n    data = data.sort((x, y) => d3.ascending(x.region, y.region));\n  } else {\n    data = data.sort((x, y) => d3.ascending(x.key, y.key));\n  }\n\n  return data;\n}\n\n/**\n *\n * @param {*} data\n * @param {*} threshold\n * @param {*} xFunc\n * @param {*} yFunc\n */\nfunction filterData(data, threshold, xFunc, yFunc) {\n  return data.filter((country, index) => {\n    country.valuesFilter = country.values.filter(year => {\n      return isfinite(xFunc(year)) && isfinite(yFunc(year));\n    });\n\n    const keep = country.valuesFilter.length > threshold;\n    return keep;\n  });\n}\n\n/**\n *\n * @param {*} data\n * @param {*} sortOrder\n */\nfunction limitData(data, sortOrder) {\n  const regionCounts = d3.map();\n  const filtered = data.filter((c, index) => {\n    let keep = true;\n    if (sortOrder === 'region') {\n      const region = c.region;\n      if (!regionCounts.has(region)) {\n        regionCounts.set(region, 0);\n      }\n\n      const regionCount = regionCounts.get(region);\n\n      regionCounts.set(region, regionCount + 1);\n      keep = regionCount < 6;\n    } else {\n      keep = index < 20;\n    }\n    return keep;\n  });\n\n  return filtered;\n}\n\n/**\n *\n * @param {*} props\n */\nfunction chartProps(props) {\n  const { xMetric, yMetric, scale, sortOrder } = props;\n  let { dataGrouped } = props;\n\n  const zMetric = 'year';\n  const xLabel = METRICS[xMetric].label;\n  const yLabel = METRICS[yMetric].label;\n  const zLabel = METRICS[zMetric].label;\n\n  const xFunc = d => d[METRICS[xMetric][scale]];\n  const yFunc = d => d[METRICS[yMetric][scale]];\n  const zFunc = d => d[METRICS[zMetric].display];\n\n  dataGrouped = filterData(dataGrouped, 3, xFunc, yFunc);\n\n  dataGrouped = sortData(dataGrouped, sortOrder, xFunc, yFunc, zFunc);\n\n  if (isMobile) {\n    dataGrouped = limitData(dataGrouped, sortOrder);\n  }\n\n  // var colorScale = d3\n  //   .scaleSequential(d3.interpolatePlasma)\n  //   .domain([2020, 1995]);\n\n  const tooltipTextFunc = d => {\n    const tooltipData = {\n      [xLabel]: d[METRICS[xMetric].display],\n      [yLabel]: d[METRICS[yMetric].display],\n      Population: d.population,\n    };\n    return tableContent(tooltipData, {\n      title: `${d.year}`,\n      valueFormat: formatNumber,\n    });\n  };\n\n  return {\n    dataGrouped,\n    xLabel,\n    yLabel,\n    zLabel,\n    xFunc,\n    yFunc,\n    zFunc,\n    tooltipTextFunc,\n  };\n}\n\n/**\n *\n */\nclass SmallMultipleConnected extends Component {\n  static propTypes = {\n    dataGrouped: PropTypes.array,\n    scale: PropTypes.string,\n    sortOrder: PropTypes.string,\n    colorScale: PropTypes.func,\n  };\n\n  static defaultProps = {\n    dataGrouped: [],\n    xMetric: 'hdi',\n    yMetric: 'gni',\n    scale: 'global',\n    colorScale: d => '#333',\n  };\n\n  /**\n   *\n   */\n  renderChart(chartData, chartIndex) {\n    const {\n      xFunc,\n      yFunc,\n      zFunc,\n      xLabel,\n      yLabel,\n      zLabel,\n      tooltipTextFunc,\n      xMetric,\n      yMetric,\n      scale,\n      colorScale,\n      dataGrouped,\n    } = this.props;\n\n    const annotationKey = `${chartData.key}:${yMetric}:${xMetric}:${scale}`;\n    const annotations = ANNOTATIONS[annotationKey];\n    return (\n      <Col sm={12} md={6} lg={4} key={chartData.key}>\n        <AutoWidth>\n          <ConnectedScatterPlot\n            key={chartData.key}\n            name={chartData.key}\n            data={chartData.valuesFilter}\n            xFunc={xFunc}\n            yFunc={yFunc}\n            zFunc={zFunc}\n            xLabel={xLabel}\n            yLabel={yLabel}\n            zLabel={zLabel}\n            xExtent={EXTENT}\n            yExtent={EXTENT}\n            tooltipTextFunc={tooltipTextFunc}\n            colorScale={colorScale}\n            xMetric={xMetric}\n            yMetric={yMetric}\n            scale={scale}\n            dataBackground={dataGrouped}\n            annotations={annotations}\n          />\n        </AutoWidth>\n      </Col>\n    );\n  }\n\n  /**\n   *\n   * @param {*} chartData\n   * @param {*} index\n   */\n  renderRegion(chartData, index) {\n    const { sortOrder, dataGrouped } = this.props;\n    const region = chartData.region;\n    if (sortOrder === 'region') {\n      if (index === 0) {\n        return (\n          <Col sm={12} key={region}>\n            <h3 className=\"region\">{region}</h3>\n          </Col>\n        );\n      } else {\n        const preRegion = dataGrouped[index - 1].region;\n        if (region !== preRegion) {\n          return (\n            <Col key={region} sm={12}>\n              <h3 className=\"region\">{region}</h3>\n            </Col>\n          );\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   *\n   */\n  renderLegend() {\n    const { colorScale } = this.props;\n    return <ColorLegend colorScale={colorScale} domain={[2001, 2017]} />;\n  }\n\n  /**\n   *\n   */\n  render() {\n    const { dataGrouped } = this.props;\n    return (\n      <div className=\"SmallMultipleConnected\">\n        <Row>\n          <Col sm={6}>\n            <span className=\"align-middle\">\n              Data from 2000 to 2017 for {dataGrouped.length} countries.\n              <MobileView>Explore all countries on a desktop browser.</MobileView>\n            </span>\n          </Col>\n          <Col sm={6}>{this.renderLegend()}</Col>\n        </Row>\n        <Row>{dataGrouped.map((d, i) => [this.renderRegion(d, i), this.renderChart(d, i)])}</Row>\n        <MobileView>Explore all countries on a desktop browser.</MobileView>\n      </div>\n    );\n  }\n}\n\nexport default addComputedProps(chartProps)(SmallMultipleConnected);\n","import React, { Component } from 'react';\nimport ReactGA from 'react-ga';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\n\nimport { CONFIGS } from '../../constants';\n\nimport './ConfigurePanel.scss';\n\nfunction indexOf(key, objs) {\n  const keys = objs.map(o => o.id);\n  return keys.indexOf(key);\n}\n\nclass ConfigurePanel extends Component {\n  constructor(props) {\n    super(props);\n\n    const { configs } = props;\n\n    this.toggle = this.toggle.bind(this);\n    this.click = this.click.bind(this);\n\n    const dataDisplayIndex = indexOf(configs.dataDisplay, CONFIGS.dataDisplay.options);\n\n    this.state = {\n      dataDisplay: {\n        dropdownOpen: false,\n        selectIndex: dataDisplayIndex,\n        selectedId: CONFIGS.dataDisplay.options[dataDisplayIndex].id,\n      },\n      sortOrder: {\n        dropdownOpen: false,\n        selectIndex: 0,\n        selectedId: CONFIGS.sortOrder.options[0].id,\n      },\n      scale: {\n        dropdownOpen: false,\n        selectIndex: 0,\n        selectedId: CONFIGS.scale.options[0].id,\n      },\n    };\n  }\n\n  /**\n   * When the react component updates, update the d3 vis\n   */\n  componentDidUpdate() {\n    const { configs } = this.props;\n    const { dataDisplay } = this.state;\n    const dataDisplayIndex = indexOf(configs.dataDisplay, CONFIGS.dataDisplay.options);\n\n    if (dataDisplayIndex !== dataDisplay.selectIndex) {\n      dataDisplay.selectIndex = dataDisplayIndex;\n      dataDisplay.selectedId = CONFIGS.dataDisplay.options[dataDisplayIndex].id;\n      this.setState({ dataDisplay });\n    }\n  }\n\n  toggle(dropdownId) {\n    this.setState(prevState => {\n      const data = prevState[dropdownId];\n      data.dropdownOpen = !data.dropdownOpen;\n      return { [dropdownId]: data };\n    });\n\n    ReactGA.event({\n      category: `${dropdownId}-toggled`,\n      action: dropdownId,\n    });\n  }\n\n  click(dropdownId, option, optionIndex) {\n    const { onClick } = this.props;\n    this.setState(prevState => {\n      const data = prevState[dropdownId];\n      data.selectIndex = optionIndex;\n      data.selectedId = option.id;\n      return { [dropdownId]: data };\n    });\n\n    ReactGA.event({\n      category: `${dropdownId}-clicked`,\n      action: option.id,\n    });\n\n    if (onClick) {\n      onClick(dropdownId, option.id);\n    }\n  }\n\n  renderDropdown(dropdownId) {\n    const dropdownState = this.state[dropdownId];\n    const data = CONFIGS[dropdownId];\n    const items = data.options.map((d, index) => (\n      <DropdownItem key={d.id} onClick={this.click.bind(this, dropdownId, d, index)}>\n        {d.label}\n      </DropdownItem>\n    ));\n\n    const display = data.options[dropdownState.selectIndex];\n\n    return (\n      <Dropdown\n        isOpen={this.state[dropdownId].dropdownOpen}\n        toggle={this.toggle.bind(this, dropdownId)}\n      >\n        <DropdownToggle caret>{display.label}</DropdownToggle>\n        <DropdownMenu>{items}</DropdownMenu>\n      </Dropdown>\n    );\n  }\n\n  render() {\n    const { size } = this.props;\n    if (size === 'small') {\n      return <div className=\"ConfigurePanel\">Showing {this.renderDropdown('dataDisplay')}</div>;\n    }\n\n    return (\n      <div className=\"ConfigurePanel\">\n        Showing {this.renderDropdown('dataDisplay')} sorted {this.renderDropdown('sortOrder')} using\n        a {this.renderDropdown('scale')} scale.\n      </div>\n    );\n  }\n}\nexport default ConfigurePanel;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport addComputedProps from 'react-computed-props';\nimport * as d3 from 'd3';\nimport isfinite from 'lodash.isfinite';\nimport { floatingTooltip } from '../tooltip/tooltip';\n\nimport './ConnectedScatterPlotGroups.scss';\n\nfunction isHoverEqual(a, b) {\n  if (!a && !b) {\n    return true;\n  }\n\n  if (!a && b) {\n    return false;\n  }\n  if (a && !b) {\n    return false;\n  }\n\n  return a.key === b.key;\n}\n\n/**\n *\n * @param {*} props\n */\nfunction chartProps(props) {\n  const { dataBackground, xFunc, yFunc, zFunc, colorScale, height, width, scale } = props;\n\n  let { xExtent, yExtent } = props;\n\n  const threshold = 3;\n\n  const padding = {\n    top: 20,\n    right: 20,\n    bottom: 40,\n    left: 40,\n  };\n\n  // scaling for retina displays\n  let sizeScale = 1.0;\n  if (window.devicePixelRatio) {\n    sizeScale = window.devicePixelRatio;\n  }\n\n  const radius = scale === 'local' ? 5 : 2;\n  const lineWidth = scale === 'local' ? 3 : 1;\n\n  const plotWidth = width - padding.left - padding.right;\n  const plotHeight = height - padding.top - padding.bottom;\n\n  let allData = [];\n\n  dataBackground.forEach(country => {\n    country.valuesFilter = country.values.filter(\n      datum => isfinite(xFunc(datum)) && isfinite(yFunc(datum)),\n    );\n\n    if (country.valuesFilter.length > threshold) {\n      allData = allData.concat(country.valuesFilter);\n    }\n\n    country.meanX = d3.mean(country.valuesFilter, xFunc);\n    country.meanY = d3.mean(country.valuesFilter, yFunc);\n\n    if (!xExtent) {\n      country.minX = d3.min(country.valuesFilter, xFunc);\n      country.maxX = d3.max(country.valuesFilter, xFunc);\n    }\n\n    if (!yExtent) {\n      country.minY = d3.min(country.valuesFilter, yFunc);\n      country.maxY = d3.max(country.valuesFilter, yFunc);\n    }\n  });\n\n  if (!xExtent) {\n    const xMin = d3.min(dataBackground, d => d.minX);\n    const xMax = d3.max(dataBackground, d => d.maxX);\n    xExtent = [xMin, xMax];\n  }\n\n  if (!yExtent) {\n    const yMin = d3.min(dataBackground, d => d.minY);\n    const yMax = d3.max(dataBackground, d => d.maxY);\n    yExtent = [yMin, yMax];\n  }\n\n  const xScale = d3\n    .scaleLinear()\n    .domain(xExtent)\n    .range([0, plotWidth]);\n\n  const yScale = d3\n    .scaleLinear()\n    .domain(yExtent)\n    .range([plotHeight, 0]);\n\n  const xValue = d => xScale(xFunc(d));\n  const yValue = d => yScale(yFunc(d));\n\n  const line = d3\n    .line()\n    .x(xValue)\n    .y(yValue);\n  // .curve(d3.curveCardinal.tension(0.3));\n\n  const lineCanvas = d3\n    .line()\n    .x(xValue)\n    .y(yValue);\n  // .curve(d3.curveNatural);\n  // .curve(d3.curveCardinal.tension(0.3));\n\n  let colorValue = d => '#ddd';\n  if (colorScale) {\n    colorValue = d => colorScale(zFunc(d));\n  }\n\n  let voronoiDiagram = null;\n  const pixelJitter = () => Math.random() - 0.5;\n  voronoiDiagram = d3\n    .voronoi()\n    .x(d => xValue(d) + pixelJitter())\n    .y(d => yValue(d) + pixelJitter())\n    .size([plotWidth, plotHeight])(allData);\n\n  const mouseRadius = plotWidth / 10;\n\n  const yAxis = d3.axisLeft(yScale).tickSizeOuter(0);\n  const xAxis = d3.axisBottom(xScale).tickSizeOuter(0);\n\n  return {\n    line,\n    lineCanvas,\n    threshold,\n    padding,\n    plotHeight,\n    plotWidth,\n    xScale,\n    yScale,\n    xValue,\n    yValue,\n    colorValue,\n    radius,\n    lineWidth,\n    voronoiDiagram,\n    mouseRadius,\n    xAxis,\n    yAxis,\n    sizeScale,\n  };\n}\n\n/**\n *\n */\nclass ConnectedScatterPlotGroups extends Component {\n  static propTypes = {\n    data: PropTypes.array,\n    name: PropTypes.string,\n    radius: PropTypes.number,\n    scale: PropTypes.string,\n    xFunc: PropTypes.func,\n    yFunc: PropTypes.func,\n    xLabel: PropTypes.string,\n    yLabel: PropTypes.string,\n    xExtent: PropTypes.array,\n    yExtent: PropTypes.array,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    tooltipTextFunc: PropTypes.func,\n  };\n\n  static defaultProps = {\n    data: [],\n    radius: 4,\n    height: 300,\n    width: 300,\n    name: '',\n    xFunc: d => d.x,\n    yFunc: d => d.x,\n    xLabel: '',\n    yLabel: '',\n    tooltipTextFunc: d => '',\n    colorScale: () => '#ddd',\n  };\n\n  /**\n   *\n   */\n  constructor(props) {\n    super(props);\n    this.state = { hover: null };\n\n    this.handleMouseover = this.handleMouseover.bind(this);\n    this.handleMouseout = this.handleMouseout.bind(this);\n    this.highlightCircle = this.highlightCircle.bind(this);\n  }\n\n  /**\n   * When the react component mounts, setup the d3 vis\n   */\n  componentDidMount() {\n    this.setup();\n  }\n\n  /**\n   * When the react component updates, update the d3 vis\n   */\n  componentDidUpdate() {\n    this.update();\n  }\n\n  /**\n   *\n   */\n  handleMouseover(el) {\n    const { voronoiDiagram, mouseRadius } = this.props;\n\n    let mousePos = d3.mouse(el);\n    mousePos = this.zoomTransform.invert(mousePos);\n    const site = voronoiDiagram.find(mousePos[0], mousePos[1], mouseRadius);\n    this.highlightCircle(site && site.data);\n  }\n\n  /**\n   *\n   */\n  handleMouseout(el) {\n    this.highlightCircle(null);\n  }\n\n  /**\n   *\n   */\n  highlightCircle(d) {\n    const { xFunc, yFunc, colorScale, colorBy, tooltipTextFunc, onHover } = this.props;\n\n    let { xScale, yScale } = this.props;\n    const { hover } = this.state;\n\n    xScale = this.zoomTransform.rescaleX(xScale);\n    yScale = this.zoomTransform.rescaleY(yScale);\n\n    if (!d) {\n      this.highlight.style('display', 'none');\n      this.tooltip.hideTooltip();\n    } else {\n      this.highlight\n        .style('display', '')\n        .style('stroke', colorScale(d[colorBy]))\n        .attr('cx', xScale(xFunc(d)))\n        .attr('cy', yScale(yFunc(d)));\n      if (tooltipTextFunc) {\n        this.tooltip.showTooltip(tooltipTextFunc(d), d3.event);\n      }\n    }\n\n    if (!isHoverEqual(hover, d)) {\n      this.setState({ hover: d });\n    }\n\n    if (onHover) {\n      onHover(d);\n    }\n  }\n\n  /**\n   *\n   */\n  setup() {\n    const { plotWidth, plotHeight, radius } = this.props;\n\n    this.zoomTransform = d3.zoomIdentity;\n\n    const cRoot = d3.select(this.root);\n\n    this.g = cRoot.append('g');\n\n    const that = this;\n    this.underlay = this.g\n      .append('rect')\n      .classed('underlay', true)\n      .attr('width', plotWidth)\n      .attr('height', plotHeight)\n      .style('fill', 'white')\n      .style('opacity', 0.0001)\n      .on('mousemove', function(d) {\n        that.handleMouseover(this, d);\n      })\n      .on('mouseleave', function() {\n        that.handleMouseout();\n      });\n    this.chart = this.g.append('g').classed('chart-group', true);\n    this.tooltip = floatingTooltip('grouped_tooltip', { xOffset: 15, yOffset: 40 });\n\n    this.highlight = this.g\n      .append('circle')\n      .attr('class', 'highlight-circle')\n      .attr('r', radius + 2)\n      .style('fill', 'none')\n      .style('pointer-events', 'none')\n      .style('display', 'none');\n\n    this.xAxis = this.g\n      .append('g')\n      .classed('x-axis', true)\n      .style('pointer-events', 'none');\n\n    this.xAxis.append('line').classed('bar', true);\n    this.xAxis.append('text').classed('low', true);\n    this.xAxis.append('text').classed('high', true);\n\n    this.yAxis = this.g\n      .append('g')\n      .classed('y-axis', true)\n      .style('pointer-events', 'none');\n\n    this.yAxis.append('line').classed('bar', true);\n    this.yAxis.append('text').classed('low', true);\n    this.yAxis.append('text').classed('high', true);\n\n    this.yAxisLabel = this.g\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle');\n\n    this.xAxisLabel = this.g\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle');\n\n    this.update();\n  }\n\n  /**\n   *\n   */\n  update() {\n    const { padding } = this.props;\n    this.g.attr('transform', `translate(${padding.left} ${padding.top})`);\n\n    this.updateLayout();\n    this.updateAxes();\n    this.updateCanvas();\n  }\n\n  /**\n   *\n   */\n  updateLayout() {\n    const { plotHeight, plotWidth } = this.props;\n\n    this.underlay.attr('width', plotWidth).attr('height', plotHeight);\n  }\n\n  updateAxes() {\n    const { xMetric, yMetric, xLabel, yLabel, plotHeight, plotWidth, padding } = this.props;\n\n    this.xAxis.attr('transform', `translate(${0}, ${plotHeight})`);\n    this.xAxis.attr('font-size', 10).attr('fill', 'none');\n    this.yAxis.attr('font-size', 10).attr('fill', 'none');\n\n    const xLowText = xMetric === 'gini' ? 'more equal' : 'low';\n    const xHighText = xMetric === 'gini' ? 'less equal' : 'high';\n\n    const yLowText = yMetric === 'gini' ? 'more equal' : 'low';\n    const yHighText = yMetric === 'gini' ? 'less equal' : 'high';\n\n    this.xAxis\n      .select('.bar')\n      .attr('x1', 0)\n      .attr('x2', plotWidth)\n      .attr('y1', 0)\n      .attr('y2', 0)\n      .style('stroke-width', 1)\n      .style('stroke', 'black')\n      .style('fill', 'none');\n\n    this.xAxis\n      .select('.low')\n      .attr('y', 9)\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .text(xLowText);\n\n    this.xAxis\n      .select('.high')\n      .attr('y', 9)\n      .attr('x', plotWidth)\n      .attr('text-anchor', 'end')\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .text(xHighText);\n\n    this.yAxis\n      .select('.bar')\n      .attr('x1', 0)\n      .attr('x2', 0)\n      .attr('y1', 0)\n      .attr('y2', plotHeight)\n      .style('stroke-width', 1)\n      .style('stroke', 'black')\n      .style('fill', 'none');\n\n    this.yAxis\n      .select('.low')\n      .attr('y', 9)\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .attr('transform', `rotate(270) translate(${-plotHeight} ${-padding.left + 18})`)\n      .text(yLowText);\n\n    this.yAxis\n      .select('.high')\n      .attr('y', 9)\n      .attr('x', 0)\n      .attr('text-anchor', 'end')\n      .attr('fill', '#333')\n      .attr('dy', '0.6em')\n      .attr('transform', `rotate(270) translate(${0} ${-padding.left + 18})`)\n      .text(yHighText);\n\n    this.yAxisLabel\n      .attr('transform', `rotate(270) translate(${-plotHeight / 2} ${-padding.left + 18})`)\n      .text(yLabel);\n\n    this.xAxisLabel\n      .attr(\n        'transform',\n        `translate(${plotWidth / 2} ${plotHeight + padding.top + padding.bottom / 3})`,\n      )\n      .text(xLabel);\n  }\n\n  /**\n   * Rerenders the chart on the canvas. Recomputes data sorting and scales.\n   */\n  updateCanvas() {\n    const {\n      dataBackground,\n      sizeScale,\n      width,\n      height,\n      padding,\n      lineWidth,\n      scale,\n      lineCanvas,\n      xValue,\n      yValue,\n      radius,\n      colorValue,\n      threshold,\n    } = this.props;\n\n    const { hover } = this.state;\n\n    // get context\n    const ctx = this.canvas.getContext('2d');\n\n    lineCanvas.context(ctx);\n\n    // Reset transform to ensure scale setting is appropriate.\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    ctx.scale(sizeScale, sizeScale);\n    // draw main bars\n    ctx.clearRect(0, 0, width, height);\n    // have some padding\n    ctx.translate(padding.left, padding.top);\n    ctx.lineWidth = lineWidth;\n\n    let lineColor = d3.color('#ccc');\n    lineColor.opacity = scale === 'global' ? 0.8 : 0.15;\n    ctx.strokeStyle = lineColor.toString();\n\n    let hoverCountry = null;\n\n    dataBackground.forEach(country => {\n      if (hover && hover.country === country.key) {\n        hoverCountry = country;\n      }\n      if (country.valuesFilter.length > threshold) {\n        if (hover) {\n          ctx.beginPath();\n          lineCanvas(country.valuesFilter);\n          ctx.stroke();\n        } else {\n          for (let i = 0; i < country.valuesFilter.length - 1; i++) {\n            const segData = [country.valuesFilter[i], country.valuesFilter[i + 1]];\n            const segColor = colorValue(country.valuesFilter[i]);\n            ctx.strokeStyle = segColor.toString();\n            ctx.beginPath();\n            lineCanvas(segData);\n            ctx.stroke();\n          }\n        }\n\n        country.valuesFilter.forEach(year => {\n          let dotColor = lineColor;\n          if (!hover) {\n            dotColor = colorValue(year);\n          }\n          ctx.beginPath();\n          ctx.arc(xValue(year), yValue(year), radius, 0, 2 * Math.PI, false);\n          ctx.fillStyle = dotColor.toString();\n          ctx.fill();\n        });\n      }\n    });\n\n    lineColor = d3.color('#888');\n    lineColor.opacity = scale === 'global' ? 0.8 : 0.15;\n    ctx.strokeStyle = lineColor.toString();\n\n    if (hoverCountry) {\n      lineColor = d3.color('white');\n      lineColor.opacity = 0.8;\n      ctx.lineWidth = lineWidth * 5;\n      ctx.strokeStyle = lineColor.toString();\n\n      ctx.beginPath();\n      lineCanvas(hoverCountry.valuesFilter);\n      ctx.stroke();\n\n      ctx.lineWidth = lineWidth;\n      lineColor = d3.color('#888');\n      lineColor.opacity = scale === 'global' ? 0.8 : 0.15;\n      ctx.strokeStyle = lineColor.toString();\n      ctx.beginPath();\n      lineCanvas(hoverCountry.valuesFilter);\n      ctx.stroke();\n\n      for (let i = 0; i < hoverCountry.valuesFilter.length - 1; i++) {\n        const segData = [hoverCountry.valuesFilter[i], hoverCountry.valuesFilter[i + 1]];\n        const segColor = colorValue(hoverCountry.valuesFilter[i]);\n        ctx.strokeStyle = segColor.toString();\n        ctx.beginPath();\n        lineCanvas(segData);\n        ctx.stroke();\n      }\n\n      hoverCountry.valuesFilter.forEach(year => {\n        const dotColor = colorValue(year);\n        ctx.beginPath();\n        ctx.arc(xValue(year), yValue(year), radius, 0, 2 * Math.PI, false);\n        ctx.fillStyle = dotColor.toString();\n        ctx.fill();\n      });\n    }\n  }\n\n  /**\n   *\n   */\n  updateAxesExact() {\n    const {\n      xAxis,\n      yAxis,\n      xLabel,\n      yLabel,\n      plotHeight,\n      plotWidth,\n      padding,\n      xScale,\n      yScale,\n    } = this.props;\n\n    this.xAxis.attr('transform', `translate(${0}, ${plotHeight})`).call(xAxis.scale(xScale));\n\n    this.yAxis.call(yAxis.scale(yScale));\n\n    this.yAxisLabel\n      .attr('transform', `rotate(270) translate(${-plotHeight / 2} ${-padding.left + 18})`)\n      .text(yLabel);\n\n    this.xAxisLabel\n      .attr(\n        'transform',\n        `translate(${plotWidth / 2} ${plotHeight + padding.top + padding.bottom / 3})`,\n      )\n      .text(xLabel);\n  }\n\n  /**\n   *\n   */\n  render() {\n    const { name, height, width, sizeScale } = this.props;\n\n    let canvasStyle = {\n      width: width,\n      height: height,\n    };\n\n    return (\n      <div className=\"ConnectedScatterPlotGroups\">\n        <h4 className=\"title\">{name}</h4>\n        <div className=\"chart-container\">\n          <canvas\n            className=\"chart-canvas\"\n            ref={node => {\n              this.canvas = node;\n            }}\n            style={canvasStyle}\n            width={width * sizeScale}\n            height={height * sizeScale}\n          />\n          <svg\n            className=\"chart\"\n            ref={node => {\n              this.root = node;\n            }}\n            height={height}\n            width={width}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default addComputedProps(chartProps, {\n  changeInclude: ['dataBackground', 'scale', 'sortOrder', 'width', 'height', 'xMetric', 'yMetric'],\n})(ConnectedScatterPlotGroups);\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport addComputedProps from 'react-computed-props';\nimport AutoWidth from '../AutoWidth/AutoWidth';\nimport ConnectedScatterPlotGroups from '../ConnectedScatterPlotGroups/ConnectedScatterPlotGroups';\n\nimport { tableContent } from '../tooltip/tooltip';\nimport { formatNumber } from '../../utils/format';\nimport { METRICS, EXTENT } from '../../constants';\n\nfunction chartProps(props) {\n  const { xMetric, yMetric } = props;\n  const scale = 'global';\n\n  const zMetric = 'year';\n  const xLabel = METRICS[xMetric].label;\n  const yLabel = METRICS[yMetric].label;\n  const zLabel = METRICS[zMetric].label;\n  const xFunc = d => d[METRICS[xMetric][scale]];\n  const yFunc = d => d[METRICS[yMetric][scale]];\n  const zFunc = d => d[METRICS[zMetric].display];\n\n  const tooltipTextFunc = d => {\n    const tooltipData = {\n      [xLabel]: d[METRICS[xMetric].display],\n      [yLabel]: d[METRICS[yMetric].display],\n      Population: d.population,\n    };\n    return tableContent(tooltipData, {\n      title: `${d.country} - ${d.year}`,\n      valueFormat: formatNumber,\n    });\n  };\n\n  return {\n    scale,\n    xLabel,\n    yLabel,\n    zLabel,\n    xFunc,\n    yFunc,\n    zFunc,\n    tooltipTextFunc,\n  };\n}\n\nclass BigGraph extends Component {\n  static propTypes = {\n    dataGrouped: PropTypes.array,\n    scale: PropTypes.string,\n    colorScale: PropTypes.func,\n  };\n\n  static defaultProps = {\n    dataGrouped: [],\n    xMetric: 'hdi',\n    yMetric: 'gni',\n    scale: 'global',\n    colorScale: d => '#333',\n  };\n\n  /**\n   *\n   */\n  renderBigGraph() {\n    const {\n      dataGrouped,\n      colorScale,\n      scale,\n      xLabel,\n      yLabel,\n      zLabel,\n      xFunc,\n      yFunc,\n      zFunc,\n      xMetric,\n      yMetric,\n      tooltipTextFunc,\n    } = this.props;\n\n    return (\n      <AutoWidth>\n        <ConnectedScatterPlotGroups\n          dataBackground={dataGrouped}\n          xMetric={xMetric}\n          yMetric={yMetric}\n          xFunc={xFunc}\n          yFunc={yFunc}\n          zFunc={zFunc}\n          xLabel={xLabel}\n          yLabel={yLabel}\n          zLabel={zLabel}\n          xExtent={EXTENT}\n          yExtent={EXTENT}\n          scale={scale}\n          colorScale={colorScale}\n          height={600}\n          tooltipTextFunc={tooltipTextFunc}\n        />\n      </AutoWidth>\n    );\n  }\n\n  render() {\n    return this.renderBigGraph();\n  }\n}\n\nexport default addComputedProps(chartProps)(BigGraph);\n","import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport { Container, Row, Col } from 'reactstrap';\n\nimport AutoWidth from '../AutoWidth/AutoWidth';\nimport ScatterPlot from '../ScatterPlot/ScatterPlot';\nimport { tableContent } from '../tooltip/tooltip';\nimport { formatNumber, roundNumber } from '../../utils/format';\nimport { METRICS, SCATTER_LABELS } from '../../constants';\nimport SmallMultipleConnected from '../SmallMultipleConnected/SmallMultipleConnected';\nimport ConfigurePanel from '../ConfigurePanel/ConfigurePanel';\nimport ColorLegend from '../ColorLegend/ColorLegend';\nimport BigGraph from '../BigGraph/BigGraph';\n\nimport './App.scss';\n\n/**\n *\n */\nfunction getData() {\n  const changesPath = `${process.env.PUBLIC_URL}/data/gov_data_year.csv`;\n  return d3.csv(changesPath);\n}\n\nconst STRING_COLUMNS = ['country', 'iso3c', 'iso2c', 'region', 'sub-region'];\nconst ROUND_COLUMNS = {\n  gdp_per_cap: { decimals: 0 },\n};\nconst NULL_STRING = 'NA';\n\n/**\n *\n */\nfunction normalizeMinMax(data, attr, normAttr) {\n  const minData = d3.min(data, d => d[attr]);\n  const maxData = d3.max(data, d => d[attr]);\n  data.forEach(datum => {\n    datum[normAttr] = datum[attr] ? (datum[attr] - minData) / (maxData - minData) : NaN;\n  });\n\n  return data;\n}\n\nconst EXCLUDE = ['Kuwait', 'Turkmenistan', 'Eritrea', 'Oman', 'Armenia', 'Albania'];\n\n/**\n *\n * @param {*} data\n */\nfunction processData(data) {\n  data.forEach(datum => {\n    Object.keys(datum).forEach(key => {\n      if (!STRING_COLUMNS.includes(key)) {\n        datum[key] = datum[key] === NULL_STRING ? null : +datum[key];\n      }\n      if (ROUND_COLUMNS[key]) {\n        datum[key] = datum[key] ? roundNumber(datum[key], ROUND_COLUMNS[key].decimals) : null;\n      }\n    });\n\n    datum.key = `${datum.country}:${datum.year}`;\n  });\n\n  // FILTER LOW POPULATION\n  const MIN_POP = 3000000;\n  data = data.filter(d => d.population > MIN_POP && !EXCLUDE.includes(d.country));\n\n  normalizeMinMax(data, 'hdi', 'hdi_norm');\n  normalizeMinMax(data, 'gni_per_cap', 'gni_norm');\n  normalizeMinMax(data, 'efree', 'efree_norm');\n  normalizeMinMax(data, 'gdp_per_cap', 'gdp_norm');\n  normalizeMinMax(data, 'gini', 'gini_norm');\n\n  // nest by country to get normalized by country\n  const dataByCountry = d3\n    .nest()\n    .key(d => d.country)\n    .entries(data);\n\n  dataByCountry.forEach(country => {\n    normalizeMinMax(country.values, 'gdp_per_cap', 'gdp_norm_local');\n    normalizeMinMax(country.values, 'gni_per_cap', 'gni_norm_local');\n    normalizeMinMax(country.values, 'hdi', 'hdi_norm_local');\n    normalizeMinMax(country.values, 'efree', 'efree_norm_local');\n    normalizeMinMax(country.values, 'gini', 'gini_norm_local');\n  });\n\n  return data;\n}\n\n/**\n *\n * @param {*} data\n */\nfunction groupData(data) {\n  let dataGrouped = d3\n    .nest()\n    .key(d => d.country)\n    .entries(data);\n\n  return dataGrouped;\n}\n\n/**\n *\n * @param {*} data\n */\nfunction processGroupedData(data) {\n  data.forEach(country => {\n    country.region = country.values[0].region || 'Other';\n    country[METRICS['gdp'].sortable] = d3.max(country.values, d => d[METRICS['gdp']['display']]);\n    country[METRICS['hdi'].sortable] = d3.max(country.values, d => d[METRICS['hdi']['display']]);\n    country[METRICS['efree'].sortable] = d3.max(\n      country.values,\n      d => d[METRICS['efree']['display']],\n    );\n    country[METRICS['gini'].sortable] = d3.min(country.values, d => d[METRICS['gini']['display']]);\n  });\n  return data;\n}\n\n/**\n *\n */\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      data: [],\n      dataGrouped: [],\n      focusYear: 2017,\n      scatterHover: null,\n      configs: {\n        dataDisplay: 'hdi_gdp',\n        sortOrder: 'region',\n        scale: 'local',\n      },\n      colorScale: d3.scaleSequential(d3.interpolateOranges).domain([1990, 2020]),\n    };\n\n    this.handleScatterHover = this.handleScatterHover.bind(this);\n    this.handleConfigClick = this.handleConfigClick.bind(this);\n  }\n\n  /**\n   *\n   * @param {*} hoverData\n   */\n  handleScatterHover(hoverData) {\n    const { scatterHover } = this.state;\n\n    if (hoverData) {\n      if (!scatterHover || !scatterHover.values.includes(hoverData.key)) {\n        this.setState({ scatterHover: { values: [hoverData.key] } });\n      }\n    } else {\n      this.setState({ scatterHover: null });\n    }\n  }\n\n  handleConfigClick(configId, valueId) {\n    const { configs } = this.state;\n    configs[configId] = valueId;\n    this.setState({ configs });\n  }\n\n  /**\n   *\n   */\n  componentDidMount() {\n    getData()\n      .then(processData)\n      .then(data => {\n        let dataGrouped = groupData(data);\n        dataGrouped = processGroupedData(dataGrouped);\n        this.setState({ data, dataGrouped });\n      });\n  }\n\n  /**\n   *\n   */\n  renderScatterGNIvsKDI() {\n    const { data, focusYear, scatterHover } = this.state;\n    const displayData = data.filter(d => d.year === focusYear);\n    const yFunc = d => d.hdi;\n    const xFunc = d => d.gdp_per_cap;\n\n    const xLabel = 'GDP per Capita';\n    const yLabel = 'Human Development Index';\n\n    const tooltipTextFunc = d => {\n      const tooltipData = { [xLabel]: xFunc(d), [yLabel]: yFunc(d) };\n      return tableContent(tooltipData, {\n        title: d.country,\n        valueFormat: formatNumber,\n      });\n    };\n\n    return (\n      <AutoWidth>\n        <ScatterPlot\n          data={displayData}\n          xFunc={xFunc}\n          yFunc={yFunc}\n          xLabel={xLabel}\n          yLabel={yLabel}\n          hoverData={scatterHover}\n          tooltipTextFunc={tooltipTextFunc}\n          onHover={this.handleScatterHover}\n          labels={SCATTER_LABELS.hdi}\n        />\n      </AutoWidth>\n    );\n  }\n\n  /**\n   *\n   */\n  renderScatterGNIvsEfree() {\n    const { data, focusYear, scatterHover } = this.state;\n    const displayData = data.filter(d => d.year === focusYear);\n    const xFunc = d => d.gdp_per_cap;\n    const yFunc = d => d.efree;\n\n    const xLabel = 'GDP per Capita';\n    const yLabel = 'Economic Freedom Score';\n\n    const tooltipTextFunc = d => {\n      const tooltipData = { [xLabel]: xFunc(d), [yLabel]: yFunc(d) };\n      return tableContent(tooltipData, {\n        title: d.country,\n        valueFormat: formatNumber,\n      });\n    };\n\n    return (\n      <AutoWidth>\n        <ScatterPlot\n          data={displayData}\n          xFunc={xFunc}\n          yFunc={yFunc}\n          xLabel={xLabel}\n          yLabel={yLabel}\n          hoverData={scatterHover}\n          tooltipTextFunc={tooltipTextFunc}\n          onHover={this.handleScatterHover}\n          labels={SCATTER_LABELS.efree}\n        />\n      </AutoWidth>\n    );\n  }\n\n  /**\n   *\n   */\n  renderBigGraph() {\n    const { data, dataGrouped, configs, colorScale } = this.state;\n    const [yMetric, xMetric] = configs.dataDisplay.split('_');\n\n    return (\n      <BigGraph\n        data={data}\n        dataGrouped={dataGrouped}\n        colorScale={colorScale}\n        xMetric={xMetric}\n        yMetric={yMetric}\n      />\n    );\n  }\n\n  /**\n   *\n   */\n  renderSmallMult() {\n    const { dataGrouped, configs, colorScale } = this.state;\n\n    const [yMetric, xMetric] = configs.dataDisplay.split('_');\n\n    return (\n      <SmallMultipleConnected\n        dataGrouped={dataGrouped}\n        xMetric={xMetric}\n        yMetric={yMetric}\n        scale={configs.scale}\n        sortOrder={configs.sortOrder}\n        colorScale={colorScale}\n      />\n    );\n  }\n\n  /**\n   *\n   */\n  renderConfigPanel(size = null) {\n    const { configs } = this.state;\n    return <ConfigurePanel configs={configs} size={size} onClick={this.handleConfigClick} />;\n  }\n\n  /**\n   *\n   */\n  renderLegend() {\n    const { colorScale } = this.state;\n    return <ColorLegend colorScale={colorScale} domain={[2001, 2017]} />;\n  }\n\n  /**\n   *\n   */\n  render() {\n    return (\n      <div className=\"App\">\n        <Container>\n          <Row>\n            <Col>\n              <div className=\"top-bar\">\n                <a\n                  className=\"align-middle float-right\"\n                  href=\"http://vallandingham.me/\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  vallandingham.me\n                </a>\n              </div>\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <h1>Good Governments Help People Succeed</h1>\n              <h5 className=\"author\">by Jim Vallandingham</h5>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={2} />\n            <Col sm={9}>\n              <div className=\"blank\" />\n              <p>What makes a “good” government?</p>\n              <p>\n                When answering this question, it is easy to fall back on a commonly used measurement\n                like the <strong>Gross Domestic Product (GDP)</strong> that showcases a government’s\n                power and progress. The GDP measures the value of goods and services produced in a\n                period of time. It ranks countries, and their governments, by output, with more\n                output being associated with a “better” government.\n              </p>\n\n              <p>\n                Economic progress is a tempting answer for what makes a government successful but\n                metrics like the GDP <strong>fail</strong> to explain what makes a government good\n                or bad for the <strong>individuals</strong> living under that government. A high GDP\n                doesn’t necessarily mean a high quality of life.\n              </p>\n\n              <blockquote cite=\"Thomas Jefferson\">\n                The care of human life and happiness, and not their destruction, is the first and\n                only object of good government.\n              </blockquote>\n\n              <p>\n                We, as governed people, need to take a more nuanced look at the quality of\n                government, through the lense of social well-being and enablement of individual\n                progress.\n              </p>\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <div className=\"blank\" />\n              <h2>New Metrics to Understand Progress</h2>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={2} />\n            <Col sm={9}>\n              <div className=\"line\" />\n              <p>\n                From a data perspective, many organizations and researchers have developed a variety\n                of metrics that can be used to better understand a government’s individual impact.\n                We will focus on three of these measurements.\n              </p>\n              <p>\n                The <strong>Human Development Index (HDI)</strong> combines statistics on life\n                expectancy, education, and income per capita to rank countries into tiers of\n                development. This index provides a measure of how good a government is at enabling\n                individuals to do the things they want to do, and be the people they want to be.\n              </p>\n              <p>\n                The <strong>Economic Freedom Score</strong>, calculated by the Heritage Foundation,\n                tracks how well a government enables an individual the freedom to work, produce,\n                consume, and invest in any way they please.\n              </p>\n              <p>\n                The <strong>Gini Index</strong> is a measure of inequality in the distribution of\n                individual or family income. A <strong>lower</strong> value indicates a more equal\n                distribution of wealth.\n              </p>\n              <p>\n                The good news is that these individual well-being metrics are correlated with\n                economic performance metrics like GDP.\n              </p>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={6}>{this.renderScatterGNIvsKDI()}</Col>\n            <Col md={6}>{this.renderScatterGNIvsEfree()}</Col>\n          </Row>\n          <Row>\n            <Col sm={2} />\n            <Col sm={9}>\n              <div className=\"blank\" />\n              <p>\n                Governments <strong>can</strong> achieve success in being good for both the\n                individuals being governed, and good in the amount of wealth produced.\n              </p>\n              <div className=\"blank\" />\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <h2>Progress Over Time</h2>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={2} />\n            <Col sm={9}>\n              <div className=\"line\" />\n              <p>\n                This simple snapshot of government performance on these metrics is useful, but what\n                is perhaps more interesting is a country’s progress over time, and how values for an\n                individual country change year by year.\n              </p>\n              <p>\n                The visualization below allows comparison and exploration of these metrics through{' '}\n                <strong>connected scatterplots</strong> for each country.\n              </p>\n              <p>\n                The graph uses the <strong>x</strong> and <strong>y</strong> dimensions to plot\n                different metrics, with each <strong>year</strong> of data displayed as a dot,\n                connected together by a line.\n              </p>\n              <p>\n                Display options allow us to find connections between countries and patterns within a\n                country, both at a <strong>global</strong> scale, and also at a{' '}\n                <strong>country-level</strong> scale for seeing year-to-year changes up close.\n                Individual country charts are <strong>annotated</strong> with explanations for the\n                patterns displayed.\n              </p>\n              <p>\n                After exploring the visualization{' '}\n                <a\n                  href=\"http://vallandingham.me/world_gov_challenge/analysis.nb.html\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  check out the analysis behind it\n                </a>\n                .\n              </p>\n              <p>\n                With this visualization, we can see the progress of the governments of the world\n                toward or away from what is good for their peoples, as well as what is good for\n                economic growth.\n              </p>\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={12}>\n              <div className=\"blank\" />\n            </Col>\n          </Row>\n          <Row>\n            <Col sm={6}>{this.renderConfigPanel('small')}</Col>\n            <Col sm={6}>{this.renderLegend()}</Col>\n          </Row>\n          <Row>\n            <Col sm={12}>{this.renderBigGraph()}</Col>\n          </Row>\n          <Row>\n            <div className=\"blank\" />\n            <Col sm={12}>{this.renderConfigPanel()}</Col>\n          </Row>\n\n          <Row>\n            <Col sm={12}>{this.renderSmallMult()}</Col>\n          </Row>\n          <Row>\n            <div className=\"blank\" />\n          </Row>\n          <Row>\n            <Col sm={12} className=\"footer\">\n              <p>\n                Jim Vallandingham |{' '}\n                <a href=\"http://vallandingham.me\" target=\"_blank\" rel=\"noopener noreferrer\">\n                  vallandingham.me\n                </a>{' '}\n                |{' '}\n                <a\n                  href=\"http://vallandingham.me/world_gov_challenge/analysis.nb.html\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  Analysis\n                </a>{' '}\n                | Developed for the{' '}\n                <a\n                  href=\"https://wdvp.worldgovernmentsummit.org/\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  World Data Visualization Prize\n                </a>\n              </p>\n            </Col>\n          </Row>\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './custom.scss';\nimport './index.scss';\nimport App from './components/App/App';\nimport * as serviceWorker from './serviceWorker';\n\nimport ReactGA from 'react-ga';\nReactGA.initialize('UA-17355070-1');\nReactGA.pageview(window.location.pathname + window.location.search);\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}